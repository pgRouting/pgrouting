

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pgr_tsp - Vendedor Viajante &mdash; pgRouting Manual (2.0.0)</title>
    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.0.0 (0a53b89 master)',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
<script src="../../../_static/page_history.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script type="text/javascript" src="../../../_static/theme_extras.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="pgRouting Manual (2.0.0)" href="../../../index.html" />
    <link rel="up" title="Funciones para Enrrutamiento" href="../../index.html" />
    <link rel="next" title="pgr_trsp - Camino más corto con giros restringidos (TRSP)" href="../../trsp/doc/index.html" />
    <link rel="prev" title="pgr_ksp - K caminos más cortos" href="../../ksp/doc/index.html" /> 
  </head>
  <body>
      <div class="header"><img class="rightlogo" src="../../../_static/pgrouting.png" alt="Logo"/><h1 class="heading"><a href="../../../index.html">
          <span>pgRouting Manual (2.0.0)</span></a></h1>
        <h2 class="heading"><span>pgr_tsp - Vendedor Viajante</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="../../ksp/doc/index.html">pgr_ksp - K caminos más cortos</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../doc/index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../../trsp/doc/index.html">pgr_trsp - Camino más corto con giros restringidos (TRSP)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
 <div class="line"><br/></div> <script> document.write(get_history("pgr_TSP","es")); </script>


  <div class="section" id="pgr-tsp-traveling-sales-person">
<span id="pgr-tsp"></span><h1>pgr_tsp - Vendedor Viajante<a class="headerlink" href="#pgr-tsp-traveling-sales-person" title="Enlazar permanentemente con este título">¶</a></h1>
<div class="section" id="name">
<span id="index-0"></span><h2>Nombre<a class="headerlink" href="#name" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pgr_tsp</span></tt> - Devuelve la mejor ruta desde un nodo inicial vía un lista de nodos.</li>
<li><tt class="docutils literal"><span class="pre">pgr_tsp</span></tt> - Devuelve el mejor orden de la ruta cuando se le introduce una matriz de distancias</li>
<li><tt class="docutils literal"><span class="pre">pgr_makeDistanceMatrix</span></tt> - Devuelve una matriz de distancias Euclidiana desde los puntos que le provee la consulta sql.</li>
</ul>
</div>
<div class="section" id="synopsis">
<h2>Sinopsis<a class="headerlink" href="#synopsis" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En el problema del vendedor viajante (TSP) o problema del vendedor se hace la siguiente pregunta: dada una lista de las ciudades y las distancias entre cada par de ciudades, ¿cuál es la ruta más corta posible que visita cada ciudad exactamente una vez y vuelve a la ciudad de origen. Este algoritmo hace simulaciones para devolver una solución aproximada de alta calidad. Devuelve un conjunto de registros <a class="reference internal" href="../../common/doc/types/cost_result.html#type-cost-result"><em>pgr_costResult</em></a> (seq, id1, id2, cost)   que conforman un camino.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">pgr_costResult</span><span class="p">[]</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="k">sql</span> <span class="nb">text</span><span class="p">,</span> <span class="n">start_id</span> <span class="nb">integer</span><span class="p">);</span>
<span class="n">pgr_costResult</span><span class="p">[]</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="k">sql</span> <span class="nb">text</span><span class="p">,</span> <span class="n">start_id</span> <span class="nb">integer</span><span class="p">,</span> <span class="n">end_id</span> <span class="nb">integer</span><span class="p">);</span>
</pre></div>
</div>
<p>Devuelve un conjunto de (seq integer, integer id1, id2 integer, cost float8) que representa el mejor orden para visitar los nodos en la matriz. <tt class="docutils literal"><span class="pre">id1</span></tt> es el índice en la matriz de distancia. <tt class="docutils literal"><span class="pre">id2</span></tt> es el identificador del punto de la consulta sql.</p>
<p>Si no se suministra el identificador de un punto de llegada <tt class="docutils literal"><span class="pre">end_id</span></tt> o si es -1 o si es el mismo que al identificador del punto de partida <tt class="docutils literal"><span class="pre">start_id</span></tt>, TSP supone que se regresa al punto de partida. Si se suministra un punto de llegada <tt class="docutils literal"><span class="pre">end_id</span></tt> entonces  se supone que la ruta inicia y termina en los identificadores designados.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="n">record</span><span class="p">[]</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="n">matrix</span> <span class="nb">float</span><span class="p">[][],</span> <span class="k">start</span> <span class="nb">integer</span><span class="p">)</span>
<span class="n">record</span><span class="p">[]</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="n">matrix</span> <span class="nb">float</span><span class="p">[][],</span> <span class="k">start</span> <span class="nb">integer</span><span class="p">,</span> <span class="k">end</span> <span class="nb">integer</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Descripción<a class="headerlink" href="#description" title="Enlazar permanentemente con este título">¶</a></h2>
<p class="rubric">Con distancias Euclidianas</p>
<p>El evaluador TSP se basa en los puntos ordenados utilizando la línea recta (euclidiana) de distancias <a class="footnote-reference" href="#f0" id="id1">[]</a> entre nodos. La aplicación utiliza un algoritmo de aproximación que es muy rápido. No es una solución exacta, pero se garantiza que una solución se devuelve después de cierta cantidad de iteraciones.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">sql:</th><td class="field-body"><p class="first">Consulta SQL que debe proporcionar un conjunto de registros con los siguientes campos:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="k">FROM</span> <span class="n">vertex_table</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">id:</th><td class="field-body"><tt class="docutils literal"><span class="pre">int4</span></tt> Identificador del vértice</td>
</tr>
<tr class="field-even field"><th class="field-name">x:</th><td class="field-body"><tt class="docutils literal"><span class="pre">float8</span></tt> coordenada x</td>
</tr>
<tr class="field-odd field"><th class="field-name">y:</th><td class="field-body"><tt class="docutils literal"><span class="pre">float8</span></tt> coordenada y</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-even field"><th class="field-name">start_id:</th><td class="field-body"><p class="first"><tt class="docutils literal"><span class="pre">int4</span></tt> Identificador del punto de partida</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">end_id:</th><td class="field-body"><p class="first last"><tt class="docutils literal"><span class="pre">int4</span></tt> identificador del punto de llegada, esto es <em>opcional</em>, si se incluye la ruta será optimizada desde la partida hasta la llegada, de lo contrario se supone que la partida y la llegada son el mismo punto.</p>
</td>
</tr>
</tbody>
</table>
<p>La función devuelve el conjunto de <a class="reference internal" href="../../common/doc/types/cost_result.html#type-cost-result"><em>pgr_costResult[]</em></a>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">seq:</th><td class="field-body">Secuencia de registros</td>
</tr>
<tr class="field-even field"><th class="field-name">id1:</th><td class="field-body">índice interno de la matriz de distancias</td>
</tr>
<tr class="field-odd field"><th class="field-name">id2:</th><td class="field-body"><tt class="docutils literal"><span class="pre">int4</span></tt> identificador del nodo</td>
</tr>
<tr class="field-even field"><th class="field-name">cost:</th><td class="field-body">costo para atravesar desde el nodo actual hasta el siguiente nodo.</td>
</tr>
</tbody>
</table>
<p class="rubric">Crear una matriz de distancias</p>
<p>Para usuarios necesitan una matriz de distancias tenemos una función simple que toma consultas SQL en <tt class="docutils literal"><span class="pre">sql</span></tt> como se describe anteriormente y devuelve un registro con  <tt class="docutils literal"><span class="pre">dmatrix</span></tt> e <tt class="docutils literal"><span class="pre">ids</span></tt>.</p>
<blockquote>
<div><div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">dmatrix</span><span class="p">,</span> <span class="n">ids</span> <span class="k">from</span> <span class="n">pgr_makeDistanceMatrix</span><span class="p">(</span><span class="s1">&#39;SELECT id, x, y FROM vertex_table&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div></blockquote>
<p>La función devuelve un registro de <tt class="docutils literal"><span class="pre">dmatrix</span></tt>, `` ids``:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">dmatrix:</th><td class="field-body"><tt class="docutils literal"><span class="pre">float8[][]</span></tt> una matriz de distancia euclidiana simétrica basado en la consulta <tt class="docutils literal"><span class="pre">sql</span></tt>.</td>
</tr>
<tr class="field-even field"><th class="field-name">ids:</th><td class="field-body"><tt class="docutils literal"><span class="pre">integer[]</span></tt> una matriz de identificadores basados en el orden de la matriz de distancias.</td>
</tr>
</tbody>
</table>
<p class="rubric">Con la matriz de distancia</p>
<p>Para los usuarios, que no requieren utilizar distancias euclidianas, tenemos también la posibilidad de pasar una matriz de distancia que resuelve y devuelve una lista ordenada de nodos con el mejor orden visita de cada nodo. Es el usuario debe llenar completamente la matriz de distancia.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">matrix:</th><td class="field-body"><tt class="docutils literal"><span class="pre">float[][]</span></tt> matriz de distancia de puntos</td>
</tr>
<tr class="field-even field"><th class="field-name">start:</th><td class="field-body"><tt class="docutils literal"><span class="pre">int4</span></tt> índice del punto de inicio</td>
</tr>
<tr class="field-odd field"><th class="field-name">end:</th><td class="field-body"><tt class="docutils literal"><span class="pre">int4</span></tt> (opcional) índice del nodo final</td>
</tr>
</tbody>
</table>
<p>El nodo final  <tt class="docutils literal"><span class="pre">end</span></tt> es un parámetro opcional, se puede omitir cuando se requiere un bucle donde el principio <tt class="docutils literal"><span class="pre">start</span></tt> es un depósito  y la ruta debe regresar de vuelta al depósito. Al incluir el parámetro  final <tt class="docutils literal"><span class="pre">end</span></tt>, se optimiza el camino de principio <tt class="docutils literal"><span class="pre">start</span></tt>  al final <tt class="docutils literal"><span class="pre">end</span></tt> y se reduce al mínimo la distancia de la ruta al ir incluyendo los puntos restantes.</p>
<p>La matriz de distancias es un <a class="reference external" href="http://www.postgresql.org/docs/9.1/static/arrays.html">array de PostgreSQL</a>  multidimensional que debe ser de tamaño <tt class="docutils literal"><span class="pre">N</span> <span class="pre">x</span> <span class="pre">N</span></tt>.</p>
<p>El resultado será de N registros de <tt class="docutils literal"><span class="pre">[</span> <span class="pre">seq,</span> <span class="pre">id</span> <span class="pre">]</span></tt>:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">seq:</th><td class="field-body">Secuencia de registros</td>
</tr>
<tr class="field-even field"><th class="field-name">id:</th><td class="field-body">índice dentro de la matriz</td>
</tr>
</tbody>
</table>
<p class="rubric">Notas al pie</p>
<table class="docutils footnote" frame="void" id="f0" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Se ha pensado sobre  precalcular las distancias de manejo entre los nodos usando Dijkstra, pero después de leer un artículo (por desgracia no recuerdo quién lo escribió), en el cuál se comprobó que la calidad del TSP con distancia euclidiana es sólo ligeramente peor que uno con las distancias reales en el caso de la distribución normal de una ciudad. En caso de una escasa red o ríos y puentes se vuelve todavía más inexacta, pero es una solución enteramente satisfactoria. Claro que es bueno tener la solución exacta, pero hay un compromiso entre la calidad y la velocidad (y el tiempo de desarrollo también). Si usted necesita una solución más precisa, puede generar una matriz de distancias y usarla para obtener los resultados.</td></tr>
</tbody>
</table>
<p class="rubric">Historia</p>
<ul class="simple">
<li>Renombrado en la versión 2.0.0</li>
<li>Dependencia de la GAUL eliminada en la versión 2.0.0</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Ejemplos<a class="headerlink" href="#examples" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li>Usando el parámetro SQL (todos los puntos de la tabla,  comenzando en 6 y terminando en 5).  En este ejemplo, hemos enumerado dos consultas, la primera puede variar de sistema a sistema porque hay varias respuestas equivalentes. La segunda consulta debe ser estable en que la ruta óptima ya que la longitud debe ser la misma independientemente del orden.</li>
</ul>
<div class="highlight-sql"><div class="highlight"><pre> <span class="k">SELECT</span> <span class="n">seq</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="n">cost</span><span class="p">::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cost</span>
   <span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;SELECT id, x, y FROM vertex_table ORDER BY id&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

  <span class="n">seq</span> <span class="o">|</span> <span class="n">id1</span> <span class="o">|</span> <span class="n">id2</span> <span class="o">|</span> <span class="n">cost</span>
 <span class="c1">-----+-----+-----+------</span>
    <span class="mi">0</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">1</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">2</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
    <span class="mi">3</span> <span class="o">|</span>   <span class="mi">1</span> <span class="o">|</span>   <span class="mi">2</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">4</span> <span class="o">|</span>   <span class="mi">0</span> <span class="o">|</span>   <span class="mi">1</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
    <span class="mi">5</span> <span class="o">|</span>   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">3</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">6</span> <span class="o">|</span>   <span class="mi">3</span> <span class="o">|</span>   <span class="mi">4</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">7</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">8</span> <span class="o">|</span>  <span class="mi">11</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">9</span> <span class="o">|</span>  <span class="mi">10</span> <span class="o">|</span>  <span class="mi">11</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
   <span class="mi">10</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
   <span class="mi">11</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>  <span class="mi">10</span> <span class="o">|</span> <span class="mi">2</span><span class="p">.</span><span class="mi">24</span>
   <span class="mi">12</span> <span class="o">|</span>   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">00</span>
 <span class="p">(</span><span class="mi">13</span> <span class="k">rows</span><span class="p">)</span>

 <span class="k">SELECT</span> <span class="n">round</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">cost</span><span class="p">)::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">cost</span>
<span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;SELECT id, x, y FROM vertex_table ORDER BY id&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

   <span class="n">cost</span>
 <span class="c1">---------</span>
  <span class="mi">15</span><span class="p">.</span><span class="mi">4787</span>
 <span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Utilizando la matriz de distancia (un circuito a partir de 1)</li>
</ul>
<p>Cuando se utiliza sólo el nodo de inicio, entoces se tiene un bucle que comienza, en este caso, con 1 y viaja a través de los otros nodos y se sobreentiende que regresa al nodo inicial desde el último nodo de la lista. Puesto que esto es un bucle, hay al menos dos posibles caminos, uno hacia la derecha y otro en sentido opuesto que tienen la misma longitud y ambos son igualmente válidos. Así que en el ejemplo siguiente también es posible recuperar una secuencia de identificadores = {1,0,3,2} en vez de la secuencia {1,2,3,0} que se obtiene a continuación.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">seq</span><span class="p">,</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;{{0,1,2,3},{1,0,4,5},{2,4,0,6},{3,5,6,0}}&#39;</span><span class="p">::</span><span class="n">float8</span><span class="p">[],</span><span class="mi">1</span><span class="p">);</span>

 <span class="n">seq</span> <span class="o">|</span> <span class="n">id</span>
<span class="c1">-----+----</span>
   <span class="mi">0</span> <span class="o">|</span>  <span class="mi">1</span>
   <span class="mi">1</span> <span class="o">|</span>  <span class="mi">2</span>
   <span class="mi">2</span> <span class="o">|</span>  <span class="mi">3</span>
   <span class="mi">3</span> <span class="o">|</span>  <span class="mi">0</span>
<span class="p">(</span><span class="mi">4</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Utilizando la matriz de distancia (a partir de 1, terminando en 2)</li>
</ul>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">seq</span><span class="p">,</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;{{0,1,2,3},{1,0,4,5},{2,4,0,6},{3,5,6,0}}&#39;</span><span class="p">::</span><span class="n">float8</span><span class="p">[],</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>

 <span class="n">seq</span> <span class="o">|</span> <span class="n">id</span>
<span class="c1">-----+----</span>
   <span class="mi">0</span> <span class="o">|</span>  <span class="mi">1</span>
   <span class="mi">1</span> <span class="o">|</span>  <span class="mi">0</span>
   <span class="mi">2</span> <span class="o">|</span>  <span class="mi">3</span>
   <span class="mi">3</span> <span class="o">|</span>  <span class="mi">2</span>
<span class="p">(</span><span class="mi">4</span> <span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>Usando la tabla de vértices edge_table_vertices_pgr generada por <a class="reference internal" href="../../common/doc/functions/create_topology.html#pgr-create-topology"><em>pgr_createTopology</em></a>. De nuevo tenemos dos consultas donde la primera puede variar y la segunda se basa en la longitud total del camino.</li>
</ul>
<div class="highlight-sql"><div class="highlight"><pre>     <span class="k">SELECT</span> <span class="n">seq</span><span class="p">,</span> <span class="n">id1</span><span class="p">,</span> <span class="n">id2</span><span class="p">,</span> <span class="n">round</span><span class="p">(</span><span class="n">cost</span><span class="p">::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">cost</span>
<span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;SELECT id::integer, st_x(the_geom) as x,st_x(the_geom) as y FROM edge_table_vertices_pgr  ORDER BY id&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

  <span class="n">seq</span> <span class="o">|</span> <span class="n">id1</span> <span class="o">|</span> <span class="n">id2</span> <span class="o">|</span> <span class="n">cost</span>
 <span class="c1">-----+-----+-----+------</span>
    <span class="mi">0</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">1</span> <span class="o">|</span>  <span class="mi">10</span> <span class="o">|</span>  <span class="mi">11</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">2</span> <span class="o">|</span>   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">3</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
    <span class="mi">3</span> <span class="o">|</span>   <span class="mi">3</span> <span class="o">|</span>   <span class="mi">4</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">4</span> <span class="o">|</span>  <span class="mi">11</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">5</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">71</span>
    <span class="mi">6</span> <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span>  <span class="mi">16</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">7</span> <span class="o">|</span>  <span class="mi">16</span> <span class="o">|</span>  <span class="mi">17</span> <span class="o">|</span> <span class="mi">2</span><span class="p">.</span><span class="mi">12</span>
    <span class="mi">8</span> <span class="o">|</span>   <span class="mi">1</span> <span class="o">|</span>   <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
    <span class="mi">9</span> <span class="o">|</span>  <span class="mi">14</span> <span class="o">|</span>  <span class="mi">15</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
   <span class="mi">10</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span>   <span class="mi">8</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
   <span class="mi">11</span> <span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>   <span class="mi">7</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">71</span>
   <span class="mi">12</span> <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span>  <span class="mi">14</span> <span class="o">|</span> <span class="mi">2</span><span class="p">.</span><span class="mi">12</span>
   <span class="mi">13</span> <span class="o">|</span>   <span class="mi">0</span> <span class="o">|</span>   <span class="mi">1</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
   <span class="mi">14</span> <span class="o">|</span>   <span class="mi">9</span> <span class="o">|</span>  <span class="mi">10</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
   <span class="mi">15</span> <span class="o">|</span>  <span class="mi">12</span> <span class="o">|</span>  <span class="mi">13</span> <span class="o">|</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
   <span class="mi">16</span> <span class="o">|</span>   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">5</span> <span class="o">|</span> <span class="mi">1</span><span class="p">.</span><span class="mi">41</span>
 <span class="p">(</span><span class="mi">17</span> <span class="k">rows</span><span class="p">)</span>

 <span class="k">SELECT</span> <span class="n">round</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">cost</span><span class="p">)::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="k">as</span> <span class="n">cost</span>
    <span class="k">FROM</span> <span class="n">pgr_tsp</span><span class="p">(</span><span class="s1">&#39;SELECT id::integer, st_x(the_geom) as x,st_x(the_geom) as y FROM edge_table_vertices_pgr  ORDER BY id&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>

   <span class="n">cost</span>
 <span class="c1">---------</span>
  <span class="mi">11</span><span class="p">.</span><span class="mi">3137</span>
 <span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<p>Las consultas usan la red de ejemplo  <a class="reference internal" href="../../../doc/src/developer/sampledata.html#sampledata"><em>Datos Muestra</em></a></p>
</div>
<div class="section" id="see-also">
<h2>Véase también<a class="headerlink" href="#see-also" title="Enlazar permanentemente con este título">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="../../common/doc/types/cost_result.html#type-cost-result"><em>pgr_costResult[]</em></a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Traveling_salesman_problem">http://en.wikipedia.org/wiki/Traveling_salesman_problem</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/Simulated_annealing">http://en.wikipedia.org/wiki/Simulated_annealing</a></li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="../../ksp/doc/index.html">pgr_ksp - K caminos más cortos</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../doc/index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../../trsp/doc/index.html">pgr_trsp - Camino más corto con giros restringidos (TRSP)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright pgRouting Contributors - Version 2.0.0 (0a53b89 master).
      Actualizado por última vez en Sep 24, 2013.
      Creado con <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>
