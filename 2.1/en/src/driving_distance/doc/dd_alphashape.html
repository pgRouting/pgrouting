<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pgr_alphaShape &mdash; pgRouting Manual (2.1.0)</title>
    
    <link rel="stylesheet" href="../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '2.1.0 (b38118a master)',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
<script src="../../../_static/page_history.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="pgRouting Manual (2.1.0)" href="../../../doc/index.html" />
    <link rel="up" title="Driving Distance" href="index.html" />
    <link rel="next" title="pgr_pointsAsPolygon" href="dd_points_as_polygon.html" />
    <link rel="prev" title="pgr_drivingDistance" href="dd_driving_distance_v3.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><img class="rightlogo" src="../../../_static/pgrouting.png" alt="Logo"/><h1 class="heading"><a href="../../../index.html">
          <span>pgRouting Manual (2.1.0)</span></a></h1>
        <h2 class="heading"><span>pgr_alphaShape</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="dd_driving_distance_v3.html">pgr_drivingDistance</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../doc/index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="dd_points_as_polygon.html">pgr_pointsAsPolygon</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
 <div class="line"><br/></div> <script> document.write(get_history("pgr_alphaShape","en")); </script>


  <div class="section" id="pgr-alphashape">
<span id="id1"></span><h1>pgr_alphaShape<a class="headerlink" href="#pgr-alphashape" title="Permalink to this headline">¶</a></h1>
<div class="section" id="name">
<span id="index-0"></span><h2>Name<a class="headerlink" href="#name" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">pgr_alphaShape</span></code> — Core function for alpha shape computation.</p>
</div>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<p>Returns a table with (x, y) rows that describe the vertices of an alpha shape.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">table</span><span class="p">()</span> <span class="n">pgr_alphaShape</span><span class="p">(</span><span class="nb">text</span> <span class="k">sql</span> <span class="p">[,</span> <span class="n">float8</span> <span class="n">alpha</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">sql:</th><td class="field-body"><p class="first"><code class="docutils literal"><span class="pre">text</span></code> a SQL query, which should return a set of rows with the following columns:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="k">FROM</span> <span class="n">vertex_table</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">id:</th><td class="field-body"><code class="docutils literal"><span class="pre">int4</span></code> identifier of the vertex</td>
</tr>
<tr class="field-even field"><th class="field-name">x:</th><td class="field-body"><code class="docutils literal"><span class="pre">float8</span></code> x-coordinate</td>
</tr>
<tr class="field-odd field"><th class="field-name">y:</th><td class="field-body"><code class="docutils literal"><span class="pre">float8</span></code> y-coordinate</td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="field-even field"><th class="field-name">alpha:</th><td class="field-body"><p class="first last">(optional) <code class="docutils literal"><span class="pre">float8</span></code> alpha value. If specified alpha value equals 0 (default), then optimal alpha value is used.
For more information, see <a class="reference external" href="http://doc.cgal.org/latest/Alpha_shapes_2/group__PkgAlphaShape2.html">CGAL - 2D Alpha Shapes</a>.</p>
</td>
</tr>
</tbody>
</table>
<p>Returns a vertex record for each row:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">x:</th><td class="field-body">x-coordinate</td>
</tr>
<tr class="field-even field"><th class="field-name">y:</th><td class="field-body">y-coordinate</td>
</tr>
</tbody>
</table>
<p>If a result includes multiple outer/inner rings, return those with separator row (x=NULL and y=NULL).</p>
<p class="rubric">History</p>
<ul class="simple">
<li>Renamed in version 2.0.0</li>
<li>Added alpha argument with default 0 (use optimal value) in version 2.1.0</li>
<li>Supported to return multiple outer/inner ring coordinates with separator row (x=NULL and y=NULL) in version 2.1.0</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>In the alpha shape code we have no way to control the order of the points so the actual output you might get could be similar but different. The simple query is followed by a more complex one that constructs a polygon and computes the areas of it. This should be the same as the result on your system. We leave the details of the complex query to the reader as an exercise if they wish to decompose it into understandable pieces or to just copy and paste it into a SQL window to run.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pgr_alphaShape</span><span class="p">(</span><span class="s1">&#39;SELECT id, x, y FROM vertex_table&#39;</span><span class="p">);</span>

 <span class="n">x</span> <span class="o">|</span> <span class="n">y</span>
<span class="c1">---+---</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="mi">4</span>
 <span class="mi">0</span> <span class="o">|</span> <span class="mi">2</span>
 <span class="mi">2</span> <span class="o">|</span> <span class="mi">0</span>
 <span class="mi">4</span> <span class="o">|</span> <span class="mi">1</span>
 <span class="mi">4</span> <span class="o">|</span> <span class="mi">2</span>
 <span class="mi">4</span> <span class="o">|</span> <span class="mi">3</span>
<span class="p">(</span><span class="mi">6</span> <span class="k">rows</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">round</span><span class="p">(</span><span class="n">ST_Area</span><span class="p">(</span><span class="n">ST_MakePolygon</span><span class="p">(</span><span class="n">ST_AddPoint</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">openline</span><span class="p">,</span> <span class="n">ST_StartPoint</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">openline</span><span class="p">))))::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">st_area</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ST_MakeLine</span><span class="p">(</span><span class="n">points</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">openline</span> <span class="k">FROM</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">ST_MakePoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">AS</span> <span class="n">points</span><span class="p">,</span> <span class="n">row_number</span><span class="p">()</span> <span class="n">over</span><span class="p">()</span> <span class="k">AS</span> <span class="n">id</span>
<span class="k">FROM</span> <span class="n">pgr_alphaShape</span><span class="p">(</span><span class="s1">&#39;SELECT id, x, y FROM vertex_table&#39;</span><span class="p">)</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">a</span><span class="p">)</span> <span class="k">AS</span> <span class="n">foo</span><span class="p">;</span>

 <span class="n">st_area</span>
<span class="c1">---------</span>
   <span class="mi">10</span><span class="p">.</span><span class="mi">00</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>


<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pgr_alphaShape</span><span class="p">(</span><span class="s1">&#39;SELECT id::integer, ST_X(the_geom)::float AS x, ST_Y(the_geom)::float AS y FROM edge_table_vertices_pgr&#39;</span><span class="p">);</span>
  <span class="n">x</span>  <span class="o">|</span>  <span class="n">y</span>
<span class="c1">-----+-----</span>
   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">4</span>
 <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> <span class="o">|</span> <span class="mi">3</span><span class="p">.</span><span class="mi">5</span>
   <span class="mi">0</span> <span class="o">|</span>   <span class="mi">2</span>
   <span class="mi">2</span> <span class="o">|</span>   <span class="mi">0</span>
   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">1</span>
   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">2</span>
   <span class="mi">4</span> <span class="o">|</span>   <span class="mi">3</span>
 <span class="mi">3</span><span class="p">.</span><span class="mi">5</span> <span class="o">|</span>   <span class="mi">4</span>
<span class="p">(</span><span class="mi">8</span> <span class="k">rows</span><span class="p">)</span>

<span class="k">SELECT</span> <span class="n">round</span><span class="p">(</span><span class="n">ST_Area</span><span class="p">(</span><span class="n">ST_MakePolygon</span><span class="p">(</span><span class="n">ST_AddPoint</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">openline</span><span class="p">,</span> <span class="n">ST_StartPoint</span><span class="p">(</span><span class="n">foo</span><span class="p">.</span><span class="n">openline</span><span class="p">))))::</span><span class="nb">numeric</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">AS</span> <span class="n">st_area</span>
<span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ST_MakeLine</span><span class="p">(</span><span class="n">points</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">id</span><span class="p">)</span> <span class="k">AS</span> <span class="n">openline</span> <span class="k">FROM</span>
<span class="p">(</span><span class="k">SELECT</span> <span class="n">ST_MakePoint</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">AS</span> <span class="n">points</span><span class="p">,</span> <span class="n">row_number</span><span class="p">()</span> <span class="n">over</span><span class="p">()</span> <span class="k">AS</span> <span class="n">id</span>
<span class="k">FROM</span> <span class="n">pgr_alphaShape</span><span class="p">(</span><span class="s1">&#39;SELECT id::integer, ST_X(the_geom)::float AS x, ST_Y(the_geom)::float AS y FROM edge_table_vertices_pgr&#39;</span><span class="p">)</span>
<span class="p">)</span> <span class="k">AS</span> <span class="n">a</span><span class="p">)</span> <span class="k">AS</span> <span class="n">foo</span><span class="p">;</span>

 <span class="n">st_area</span>
<span class="c1">---------</span>
   <span class="mi">11</span><span class="p">.</span><span class="mi">75</span>
<span class="p">(</span><span class="mi">1</span> <span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<p>The queries use the <a class="reference internal" href="../../../doc/src/developer/sampledata.html#sampledata"><span>Sample Data</span></a> network.</p>
</div>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference internal" href="index.html#pgr-driving-distance"><span>Driving Distance</span></a> - Driving Distance</li>
<li><a class="reference internal" href="dd_points_as_polygon.html#pgr-points-as-polygon"><span>pgr_pointsAsPolygon</span></a> - Polygon around set of points</li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="dd_driving_distance_v3.html">pgr_drivingDistance</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../../doc/index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="dd_points_as_polygon.html">pgr_pointsAsPolygon</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright pgRouting Contributors - Version 2.1.0 (b38118a master).
      Last updated on Sep 06, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>
