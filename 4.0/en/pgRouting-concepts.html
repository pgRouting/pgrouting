

<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pgRouting Concepts &#8212; pgRouting Manual (4.0-dev)</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css?v=5a695559" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx_collapse.css?v=226d88b4" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=e38b2961" />
    <script src="_static/documentation_options.js?v=798e95cd"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/page_history.js?v=1e711df0"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Function Families" href="routingFunctions.html" />
    <link rel="prev" title="Sample Data" href="sampledata.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="index.html">
          pgRouting</a>
        <span class="navbar-text pull-left"><b>v4.0</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampledata.html">Sample Data</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">pgRouting Concepts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="routingFunctions.html">Function Families</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proposed.html">Proposed Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Experimental Functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration guide</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">pgRouting Concepts</a><ul>
<li><a class="reference internal" href="#graphs">Graphs</a><ul>
<li><a class="reference internal" href="#graph-definition">Graph definition</a></li>
<li><a class="reference internal" href="#graph-with-cost">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code></a></li>
<li><a class="reference internal" href="#graph-with-cost-and-reverse-cost">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphs-without-geometries">Graphs without geometries</a><ul>
<li><a class="reference internal" href="#wiki-example">Wiki example</a><ul>
<li><a class="reference internal" href="#prepare-the-database">Prepare the database</a></li>
<li><a class="reference internal" href="#create-a-table">Create a table</a></li>
<li><a class="reference internal" href="#insert-the-data">Insert the data</a></li>
<li><a class="reference internal" href="#find-the-shortest-path">Find the shortest path</a></li>
<li><a class="reference internal" href="#vertex-information">Vertex information</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#graphs-with-geometries">Graphs with geometries</a><ul>
<li><a class="reference internal" href="#create-a-routing-database">Create a routing Database</a></li>
<li><a class="reference internal" href="#load-data">Load Data</a></li>
<li><a class="reference internal" href="#build-a-routing-topology">Build a routing topology</a></li>
<li><a class="reference internal" href="#adjust-costs">Adjust costs</a><ul>
<li><a class="reference internal" href="#update-costs-to-length-of-geometry">Update costs to length of geometry</a></li>
<li><a class="reference internal" href="#update-costs-based-on-codes">Update costs based on codes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#check-the-routing-topology">Check the Routing Topology</a><ul>
<li><a class="reference internal" href="#crossing-edges">Crossing edges</a></li>
<li><a class="reference internal" href="#fixing-an-intersection">Fixing an intersection</a></li>
<li><a class="reference internal" href="#disconnected-graphs">Disconnected graphs</a><ul>
<li><a class="reference internal" href="#prepare-storage-for-connection-information">Prepare storage for connection information</a></li>
<li><a class="reference internal" href="#save-the-vertices-connection-information">Save the vertices connection information</a></li>
<li><a class="reference internal" href="#save-the-edges-connection-information">Save the edges connection information</a></li>
<li><a class="reference internal" href="#get-the-closest-vertex">Get the closest vertex</a></li>
<li><a class="reference internal" href="#connecting-components">Connecting components</a></li>
<li><a class="reference internal" href="#checking-components">Checking components</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contraction-of-a-graph">Contraction of a graph</a><ul>
<li><a class="reference internal" href="#dead-ends">Dead ends</a></li>
<li><a class="reference internal" href="#linear-edges">Linear edges</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#function-s-structure">Function’s structure</a></li>
<li><a class="reference internal" href="#function-s-overloads">Function’s overloads</a><ul>
<li><a class="reference internal" href="#one-to-one">One to One</a></li>
<li><a class="reference internal" href="#one-to-many">One to Many</a></li>
<li><a class="reference internal" href="#many-to-one">Many to One</a></li>
<li><a class="reference internal" href="#many-to-many">Many to Many</a></li>
<li><a class="reference internal" href="#combinations">Combinations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inner-queries">Inner Queries</a><ul>
<li><a class="reference internal" href="#edges-sql">Edges SQL</a><ul>
<li><a class="reference internal" href="#general">General</a></li>
<li><a class="reference internal" href="#general-without-id">General without <code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li><a class="reference internal" href="#general-with-x-y">General with (X,Y)</a></li>
<li><a class="reference internal" href="#flow">Flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combinations-sql">Combinations SQL</a></li>
<li><a class="reference internal" href="#restrictions-sql">Restrictions SQL</a></li>
<li><a class="reference internal" href="#points-sql">Points SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">Parameters</a><ul>
<li><a class="reference internal" href="#parameters-for-the-via-functions">Parameters for the Via functions</a></li>
<li><a class="reference internal" href="#for-the-trsp-functions">For the TRSP functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-columns">Result columns</a><ul>
<li><a class="reference internal" href="#result-columns-for-a-path">Result columns for a path</a></li>
<li><a class="reference internal" href="#multiple-paths">Multiple paths</a><ul>
<li><a class="reference internal" href="#selective-for-multiple-paths">Selective for multiple paths.</a></li>
<li><a class="reference internal" href="#non-selective-for-multiple-paths">Non selective for multiple paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-columns-for-cost-functions">Result columns for cost functions</a></li>
<li><a class="reference internal" href="#result-columns-for-flow-functions">Result columns for flow functions</a></li>
<li><a class="reference internal" href="#result-columns-for-spanning-tree-functions">Result columns for spanning tree functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-tips">Performance Tips</a><ul>
<li><a class="reference internal" href="#for-the-routing-functions">For the Routing functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-contribute">How to contribute</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="sampledata.html" title="Previous Chapter: Sample Data"><span class="icon-chevron-left visible-tablet"></span><span class="hidden-sm hidden-tablet">&laquo; Sample Data</span>
    </a>
  </li>
  <li>
    <a href="routingFunctions.html" title="Next Chapter: Function Families"><span class="icon-chevron-right visible-tablet"></span><span class="hidden-sm hidden-tablet">Function Families &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
    <div class="row">
      <div class="span3">
        <div id="sidebar" class="bs-sidenav well" data-spy="affix"><ul>
<li><a class="reference internal" href="#">pgRouting Concepts</a><ul>
<li><a class="reference internal" href="#graphs">Graphs</a><ul>
<li><a class="reference internal" href="#graph-definition">Graph definition</a></li>
<li><a class="reference internal" href="#graph-with-cost">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code></a></li>
<li><a class="reference internal" href="#graph-with-cost-and-reverse-cost">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#graphs-without-geometries">Graphs without geometries</a><ul>
<li><a class="reference internal" href="#wiki-example">Wiki example</a><ul>
<li><a class="reference internal" href="#prepare-the-database">Prepare the database</a></li>
<li><a class="reference internal" href="#create-a-table">Create a table</a></li>
<li><a class="reference internal" href="#insert-the-data">Insert the data</a></li>
<li><a class="reference internal" href="#find-the-shortest-path">Find the shortest path</a></li>
<li><a class="reference internal" href="#vertex-information">Vertex information</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#graphs-with-geometries">Graphs with geometries</a><ul>
<li><a class="reference internal" href="#create-a-routing-database">Create a routing Database</a></li>
<li><a class="reference internal" href="#load-data">Load Data</a></li>
<li><a class="reference internal" href="#build-a-routing-topology">Build a routing topology</a></li>
<li><a class="reference internal" href="#adjust-costs">Adjust costs</a><ul>
<li><a class="reference internal" href="#update-costs-to-length-of-geometry">Update costs to length of geometry</a></li>
<li><a class="reference internal" href="#update-costs-based-on-codes">Update costs based on codes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#check-the-routing-topology">Check the Routing Topology</a><ul>
<li><a class="reference internal" href="#crossing-edges">Crossing edges</a></li>
<li><a class="reference internal" href="#fixing-an-intersection">Fixing an intersection</a></li>
<li><a class="reference internal" href="#disconnected-graphs">Disconnected graphs</a><ul>
<li><a class="reference internal" href="#prepare-storage-for-connection-information">Prepare storage for connection information</a></li>
<li><a class="reference internal" href="#save-the-vertices-connection-information">Save the vertices connection information</a></li>
<li><a class="reference internal" href="#save-the-edges-connection-information">Save the edges connection information</a></li>
<li><a class="reference internal" href="#get-the-closest-vertex">Get the closest vertex</a></li>
<li><a class="reference internal" href="#connecting-components">Connecting components</a></li>
<li><a class="reference internal" href="#checking-components">Checking components</a></li>
</ul>
</li>
<li><a class="reference internal" href="#contraction-of-a-graph">Contraction of a graph</a><ul>
<li><a class="reference internal" href="#dead-ends">Dead ends</a></li>
<li><a class="reference internal" href="#linear-edges">Linear edges</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#function-s-structure">Function’s structure</a></li>
<li><a class="reference internal" href="#function-s-overloads">Function’s overloads</a><ul>
<li><a class="reference internal" href="#one-to-one">One to One</a></li>
<li><a class="reference internal" href="#one-to-many">One to Many</a></li>
<li><a class="reference internal" href="#many-to-one">Many to One</a></li>
<li><a class="reference internal" href="#many-to-many">Many to Many</a></li>
<li><a class="reference internal" href="#combinations">Combinations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inner-queries">Inner Queries</a><ul>
<li><a class="reference internal" href="#edges-sql">Edges SQL</a><ul>
<li><a class="reference internal" href="#general">General</a></li>
<li><a class="reference internal" href="#general-without-id">General without <code class="docutils literal notranslate"><span class="pre">id</span></code></a></li>
<li><a class="reference internal" href="#general-with-x-y">General with (X,Y)</a></li>
<li><a class="reference internal" href="#flow">Flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combinations-sql">Combinations SQL</a></li>
<li><a class="reference internal" href="#restrictions-sql">Restrictions SQL</a></li>
<li><a class="reference internal" href="#points-sql">Points SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">Parameters</a><ul>
<li><a class="reference internal" href="#parameters-for-the-via-functions">Parameters for the Via functions</a></li>
<li><a class="reference internal" href="#for-the-trsp-functions">For the TRSP functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-columns">Result columns</a><ul>
<li><a class="reference internal" href="#result-columns-for-a-path">Result columns for a path</a></li>
<li><a class="reference internal" href="#multiple-paths">Multiple paths</a><ul>
<li><a class="reference internal" href="#selective-for-multiple-paths">Selective for multiple paths.</a></li>
<li><a class="reference internal" href="#non-selective-for-multiple-paths">Non selective for multiple paths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-columns-for-cost-functions">Result columns for cost functions</a></li>
<li><a class="reference internal" href="#result-columns-for-flow-functions">Result columns for flow functions</a></li>
<li><a class="reference internal" href="#result-columns-for-spanning-tree-functions">Result columns for spanning tree functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-tips">Performance Tips</a><ul>
<li><a class="reference internal" href="#for-the-routing-functions">For the Routing functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-contribute">How to contribute</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="sampledata.html" title="Previous Chapter: Sample Data"><span class="icon-chevron-left visible-tablet"></span><span class="hidden-sm hidden-tablet">&laquo; Sample Data</span>
    </a>
  </li>
  <li>
    <a href="routingFunctions.html" title="Next Chapter: Function Families"><span class="icon-chevron-right visible-tablet"></span><span class="hidden-sm hidden-tablet">Function Families &raquo;</span>
    </a>
  </li>
<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
        <div class="body span9 content" role="main">
            <script> document.write(get_history('pgRouting-concepts','en'));  </script>
            
  <div class="line-block">
<div class="line"><br /></div>
</div>
<section id="pgrouting-concepts">
<h1>pgRouting Concepts<a class="headerlink" href="#pgrouting-concepts" title="Link to this heading">¶</a></h1>
<p>This is a simple guide that go through some of the steps for getting started
with pgRouting. This guide covers:</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#graphs" id="id8">Graphs</a></p></li>
<li><p><a class="reference internal" href="#graphs-without-geometries" id="id9">Graphs without geometries</a></p></li>
<li><p><a class="reference internal" href="#graphs-with-geometries" id="id10">Graphs with geometries</a></p></li>
<li><p><a class="reference internal" href="#check-the-routing-topology" id="id11">Check the Routing Topology</a></p></li>
<li><p><a class="reference internal" href="#function-s-structure" id="id12">Function’s structure</a></p></li>
<li><p><a class="reference internal" href="#function-s-overloads" id="id13">Function’s overloads</a></p></li>
<li><p><a class="reference internal" href="#inner-queries" id="id14">Inner Queries</a></p></li>
<li><p><a class="reference internal" href="#parameters" id="id15">Parameters</a></p></li>
<li><p><a class="reference internal" href="#result-columns" id="id16">Result columns</a></p></li>
<li><p><a class="reference internal" href="#performance-tips" id="id17">Performance Tips</a></p></li>
<li><p><a class="reference internal" href="#how-to-contribute" id="id18">How to contribute</a></p></li>
</ul>
</nav>
<section id="graphs">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Graphs</a><a class="headerlink" href="#graphs" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id1">
<ul class="simple">
<li><p><a class="reference internal" href="#graph-definition" id="id19">Graph definition</a></p></li>
<li><p><a class="reference internal" href="#graph-with-cost" id="id20">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code></a></p></li>
<li><p><a class="reference internal" href="#graph-with-cost-and-reverse-cost" id="id21">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></a></p></li>
</ul>
</nav>
<section id="graph-definition">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Graph definition</a><a class="headerlink" href="#graph-definition" title="Link to this heading">¶</a></h3>
<p>A graph is an ordered pair <span class="math notranslate nohighlight">\(G = (V ,E)\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V\)</span> is a set of vertices, also called nodes.</p></li>
<li><p><span class="math notranslate nohighlight">\(E \subseteq \{( u, v ) \mid u , v \in V \}\)</span></p></li>
</ul>
<p>There are different kinds of graphs:</p>
<ul class="simple">
<li><p>Undirected graph</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(E \subseteq \{( u, v ) \mid u , v \in V\}\)</span></p></li>
</ul>
</li>
<li><p>Undirected simple graph</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(E \subseteq \{( u, v ) \mid u , v \in V, u \neq v\}\)</span></p></li>
</ul>
</li>
<li><p>Directed graph</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(E \subseteq \{( u, v ) \mid (u , v) \in (V X V) \}\)</span></p></li>
</ul>
</li>
<li><p>Directed simple graph</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(E \subseteq \{( u, v ) \mid (u , v) \in (V X V), u \neq v\}\)</span></p></li>
</ul>
</li>
</ul>
<p>Graphs:</p>
<ul class="simple">
<li><p>Do not have geometries.</p></li>
<li><p>Some graph theory problems require graphs to have weights, called <strong>cost</strong> in
pgRouting.</p></li>
</ul>
<p>In pgRouting there are several ways to represent a graph on the database:</p>
<ul class="simple">
<li><p>With <code class="docutils literal notranslate"><span class="pre">cost</span></code></p>
<ul>
<li><p>(<code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">cost</span></code>)</p></li>
</ul>
</li>
<li><p>With <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p>
<ul>
<li><p>(<code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">cost</span></code>, <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>)</p></li>
</ul>
</li>
</ul>
<p>Where:</p>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p>Identifier of the edge. Requirement to use the database in a consistent.
manner.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p>Identifier of a vertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p>Identifier of a vertex.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>):</p>
<ul class="simple">
<li><p>When negative the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>) do not exist on the
graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cost</span></code> must exist in the query.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>)</p>
<ul class="simple">
<li><p>When negative the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) do not exist on the
graph.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>The decision of the graph to be <strong>directed</strong> or <strong>undirected</strong> is done when
executing a pgRouting algorithm.</p>
</section>
<section id="graph-with-cost">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code></a><a class="headerlink" href="#graph-with-cost" title="Link to this heading">¶</a></h3>
<p>The weighted directed graph, <span class="math notranslate nohighlight">\(G_d(V,E)\)</span>:</p>
<ul>
<li><p>Graph data is obtained with a query</p>
<p><code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">id,</span> <span class="pre">source,</span> <span class="pre">target,</span> <span class="pre">cost</span> <span class="pre">FROM</span> <span class="pre">edges</span></code></p>
</li>
<li><p>the set of edges <span class="math notranslate nohighlight">\(E\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E = \{(source_{id}, target_{id}, cost_{id}) \text{ when } cost_{id}
\ge 0 \}\)</span></p></li>
<li><p>Edges where <code class="docutils literal notranslate"><span class="pre">cost</span></code> is non negative are part of the graph.</p></li>
</ul>
</li>
<li><p>the set of vertices <span class="math notranslate nohighlight">\(V\)</span></p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V = \{source_{id} \cup target_{id}\}\)</span></p></li>
<li><p>All vertices in <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> are part of the graph.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Directed graph</p>
<p>In a directed graph the edge <span class="math notranslate nohighlight">\((source_{id}, target_{id}, cost_{id})\)</span> has
directionality: <span class="math notranslate nohighlight">\(source_{id} \rightarrow target_{id}\)</span></p>
<p>For the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
     <span class="n">AS</span> <span class="n">t</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">source</span> <span class="o">|</span> <span class="n">target</span> <span class="o">|</span> <span class="n">cost</span>
<span class="o">----+--------+--------+------</span>
  <span class="mi">1</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>    <span class="mi">5</span>
  <span class="mi">2</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">3</span>
<span class="p">(</span><span class="mi">2</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Edge <span class="math notranslate nohighlight">\(2\)</span> (<span class="math notranslate nohighlight">\(1 \rightarrow 3\)</span>) is not part of the graph.</p>
<p>The data is representing the following graph:</p>
<div class="graphviz"><img src="_images/graphviz-6a22e17e4c49cbe911a2c3c04aea2e93942005ce.png" alt="digraph G {
 1 -&gt; 2 [label=&quot;1(5)&quot;];
 3;
}" class="graphviz" /></div>
<p class="rubric">Undirected graph</p>
<p>In an undirected graph the edge <span class="math notranslate nohighlight">\((source_{id}, target_{id}, cost_{id})\)</span>
does not have directionality: <span class="math notranslate nohighlight">\(source_{id} \frac{\;\;\;\;\;}{}
target_{id}\)</span></p>
<ul class="simple">
<li><p>In terms of a directed graph is like having two edges: <span class="math notranslate nohighlight">\(source_{id}
\leftrightarrow target_{id}\)</span></p></li>
</ul>
<p>For the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">))</span>
     <span class="n">AS</span> <span class="n">t</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">source</span> <span class="o">|</span> <span class="n">target</span> <span class="o">|</span> <span class="n">cost</span>
<span class="o">----+--------+--------+------</span>
  <span class="mi">1</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>    <span class="mi">5</span>
  <span class="mi">2</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">3</span>
<span class="p">(</span><span class="mi">2</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Edge <span class="math notranslate nohighlight">\(2\)</span> (<span class="math notranslate nohighlight">\(1 \frac{\;\;\;\;\;}{} 3\)</span>) is not part of the graph.</p>
<p>The data is representing the following graph:</p>
<div class="graphviz"><img src="_images/graphviz-a9ff7d505ee3aa8158a1f3439d4325a71f0dbcae.png" alt="graph G {
 1 -- 2 [label=&quot;1(5)&quot;];
 3;
}" class="graphviz" /></div>
</section>
<section id="graph-with-cost-and-reverse-cost">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Graph with <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></a><a class="headerlink" href="#graph-with-cost-and-reverse-cost" title="Link to this heading">¶</a></h3>
<p>The weighted directed graph, <span class="math notranslate nohighlight">\(G_d(V,E)\)</span>, is defined by:</p>
<ul>
<li><p>Graph data is obtained with a query</p>
<p><code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">id,</span> <span class="pre">source,</span> <span class="pre">target,</span> <span class="pre">cost,</span> <span class="pre">reverse_cost</span> <span class="pre">FROM</span> <span class="pre">edges</span></code></p>
</li>
<li><p>The set of edges <span class="math notranslate nohighlight">\(E\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(E = \begin{split} \begin{align}
&amp; {\{(source_{id}, target_{id}, cost_{id}) \text{ when } cost_{id} &gt;=0 \}} \\
&amp; \cup \\
&amp; {\{(target_{id}, source_{id}, reverse\_cost_{id}) \text{ when } reverse\_cost_{id} &gt;=0 \}}
\end{align} \end{split}\)</span></p></li>
<li><p>Edges <span class="math notranslate nohighlight">\((source \rightarrow target)\)</span> where <code class="docutils literal notranslate"><span class="pre">cost</span></code> is non negative are
part of the graph.</p></li>
<li><p>Edges <span class="math notranslate nohighlight">\((target \rightarrow source)\)</span> where <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> is non
negative are part of the graph.</p></li>
</ul>
</li>
<li><p>The set of vertices <span class="math notranslate nohighlight">\(V\)</span>:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V = \{source_{id} \cup target_{id}\}\)</span></p></li>
<li><p>All vertices in <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> are part of the graph.</p></li>
</ul>
</li>
</ul>
<p class="rubric">Directed graph</p>
<p>In a directed graph both edges have directionality</p>
<ul class="simple">
<li><p>edge <span class="math notranslate nohighlight">\((source_{id}, target_{id}, cost_{id})\)</span> has directionality: <span class="math notranslate nohighlight">\(source_{id}
\rightarrow target_{id}\)</span></p></li>
<li><p>edge <span class="math notranslate nohighlight">\((target_{id}, source_{id}, reverse\_cost_{id})\)</span> has directionality:
<span class="math notranslate nohighlight">\(target_{id} \rightarrow source_{id}\)</span></p></li>
</ul>
<p>For the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
     <span class="n">AS</span> <span class="n">t</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">source</span> <span class="o">|</span> <span class="n">target</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">reverse_cost</span>
<span class="o">----+--------+--------+------+--------------</span>
  <span class="mi">1</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span>            <span class="mi">2</span>
  <span class="mi">2</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">3</span> <span class="o">|</span>            <span class="mi">4</span>
  <span class="mi">3</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>    <span class="mi">7</span> <span class="o">|</span>           <span class="o">-</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Edges not part of the graph:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(2\)</span> (<span class="math notranslate nohighlight">\(1 \rightarrow 3\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(3\)</span> (<span class="math notranslate nohighlight">\(3 \rightarrow 2\)</span>)</p></li>
</ul>
<p>The data is representing the following graph:</p>
<div class="graphviz"><img src="_images/graphviz-cf2723f26bd1c3ee60f314423c76e21eb5708d4e.png" alt="digraph G {
 1 -&gt; 2 [label=&quot;1(5)&quot;];
 2 -&gt; 1 [label=&quot;1(2)&quot;];
 3 -&gt; 1 [label=&quot;2(4)&quot;];
 2 -&gt; 3 [label=&quot;3(7)&quot;];
}" class="graphviz" /></div>
<p class="rubric">Undirected graph</p>
<p>In a directed graph both edges do not have directionality</p>
<ul class="simple">
<li><p>Edge <span class="math notranslate nohighlight">\((source_{id}, target_{id}, cost_{id})\)</span> is <span class="math notranslate nohighlight">\(source_{id}
\frac{\;\;\;\;\;}{} target_{id}\)</span></p></li>
<li><p>Edge <span class="math notranslate nohighlight">\((target_{id}, source_{id}, reverse\_cost_{id})\)</span> is
<span class="math notranslate nohighlight">\(target_{id} \frac{\;\;\;\;\;}{} source_{id}\)</span></p></li>
<li><p>In terms of a directed graph is like having four edges:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(source_i \leftrightarrow target_i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(target_i \leftrightarrow source_i\)</span></p></li>
</ul>
</li>
</ul>
<p>For the following data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">VALUES</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
     <span class="n">AS</span> <span class="n">t</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">source</span> <span class="o">|</span> <span class="n">target</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">reverse_cost</span>
<span class="o">----+--------+--------+------+--------------</span>
  <span class="mi">1</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span>            <span class="mi">2</span>
  <span class="mi">2</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">3</span> <span class="o">|</span>            <span class="mi">4</span>
  <span class="mi">3</span> <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>    <span class="mi">7</span> <span class="o">|</span>           <span class="o">-</span><span class="mi">1</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Edges not part of the graph:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(2\)</span> (<span class="math notranslate nohighlight">\(1 \frac{\;\;\;\;\;}{} 3\)</span>)</p></li>
<li><p><span class="math notranslate nohighlight">\(3\)</span> (<span class="math notranslate nohighlight">\(3 \frac{\;\;\;\;\;}{} 2\)</span>)</p></li>
</ul>
<p>The data is representing the following graph:</p>
<div class="graphviz"><img src="_images/graphviz-7cf300b7d69445756b30b2135af90e936a5dd9e4.png" alt="graph G {
 1 -- 2 [label=&quot;1(5)&quot;];
 2 -- 1 [label=&quot;1(2)&quot;];
 3 -- 1 [label=&quot;2(4)&quot;];
 2 -- 3 [label=&quot;3(7)&quot;];
}" class="graphviz" /></div>
</section>
</section>
<section id="graphs-without-geometries">
<h2><a class="toc-backref" href="#id9" role="doc-backlink">Graphs without geometries</a><a class="headerlink" href="#graphs-without-geometries" title="Link to this heading">¶</a></h2>
<p>Personal relationships, genealogy, file dependency problems can be solved
using pgRouting. Those problems, normally, do not come with geometries associated
with the graph.</p>
<nav class="contents local" id="id2">
<ul class="simple">
<li><p><a class="reference internal" href="#wiki-example" id="id22">Wiki example</a></p>
<ul>
<li><p><a class="reference internal" href="#prepare-the-database" id="id23">Prepare the database</a></p></li>
<li><p><a class="reference internal" href="#create-a-table" id="id24">Create a table</a></p></li>
<li><p><a class="reference internal" href="#insert-the-data" id="id25">Insert the data</a></p></li>
<li><p><a class="reference internal" href="#find-the-shortest-path" id="id26">Find the shortest path</a></p></li>
<li><p><a class="reference internal" href="#vertex-information" id="id27">Vertex information</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="wiki-example">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Wiki example</a><a class="headerlink" href="#wiki-example" title="Link to this heading">¶</a></h3>
<p>Solve the example problem taken from <a class="reference external" href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm">wikipedia</a>):</p>
<figure class="align-default">
<img alt="_images/Dijkstra_Animation.gif" src="_images/Dijkstra_Animation.gif" />
</figure>
<p>Where:</p>
<ul>
<li><p>Problem is to find the shortest path from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(5\)</span>.</p></li>
<li><p>Is an undirected graph.</p></li>
<li><p>Although visually looks like to have geometries, the drawing is not to scale.</p>
<ul class="simple">
<li><p>No geometries associated to the vertices or edges</p></li>
</ul>
</li>
<li><p>Has 6 vertices <span class="math notranslate nohighlight">\(\{1,2,3,4,5,6\}\)</span></p></li>
<li><p>Has 9 edges:</p>
<p><span class="math notranslate nohighlight">\(\begin{split} \begin{align}
E = &amp; \{(1,2,7), (1,3,9), (1,6,14), \\
&amp; (2,3,10), (2,4,13), \\
&amp; (3,4,11), (3,6,2), \\
&amp; (4,5,6), \\
&amp; (5,6,9) \}
\end{align} \end{split}\)</span></p>
</li>
<li><p>The graph can be represented in many ways for example:</p></li>
</ul>
<div class="graphviz"><img src="_images/graphviz-aa83b370a30d7a5c2be123929174e31044bca152.png" alt="graph G {
 rankdir=&quot;LR&quot;;
 1 [color=&quot;red&quot;];
 5 [color=&quot;green&quot;];
 1 -- 2 [label=&quot;(7)&quot;];
 5 -- 6 [label=&quot;(9)&quot;];
 1 -- 3 [label=&quot;(9)&quot;];
 1 -- 6 [label=&quot;(14)&quot;];
 2 -- 3 [label=&quot;(10)&quot;];
 2 -- 4 [label=&quot;(13)&quot;];
 3 -- 4 [label=&quot;(11)&quot;];
 3 -- 6 [label=&quot;(2)&quot;];
 4 -- 5 [label=&quot;(6)&quot;];
}" class="graphviz" /></div>
<section id="prepare-the-database">
<h4><a class="toc-backref" href="#id23" role="doc-backlink">Prepare the database</a><a class="headerlink" href="#prepare-the-database" title="Link to this heading">¶</a></h4>
<p>Create a database for the example, access the database and install pgRouting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ createdb wiki
$ psql wiki
wiki =# CREATE EXTENSION pgRouting CASCADE;
</pre></div>
</div>
</section>
<section id="create-a-table">
<h4><a class="toc-backref" href="#id24" role="doc-backlink">Create a table</a><a class="headerlink" href="#create-a-table" title="Link to this heading">¶</a></h4>
<p>The basic elements needed to perform basic routing on an undirected graph are:</p>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p>SMALLINT, INTEGER, BIGINT, REAL, FLOAT</p>
</dd>
</dl>
<p>Using this table design for this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CREATE</span> <span class="n">TABLE</span> <span class="n">wiki</span> <span class="p">(</span>
  <span class="nb">id</span> <span class="n">SERIAL</span><span class="p">,</span>
  <span class="n">source</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">target</span> <span class="n">INTEGER</span><span class="p">,</span>
  <span class="n">cost</span> <span class="n">INTEGER</span><span class="p">);</span>
<span class="n">CREATE</span> <span class="n">TABLE</span>
</pre></div>
</div>
</section>
<section id="insert-the-data">
<h4><a class="toc-backref" href="#id25" role="doc-backlink">Insert the data</a><a class="headerlink" href="#insert-the-data" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">wiki</span> <span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span> <span class="n">VALUES</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>  <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>  <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">11</span><span class="p">),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">);</span>
<span class="n">INSERT</span> <span class="mi">0</span> <span class="mi">9</span>
</pre></div>
</div>
</section>
<section id="find-the-shortest-path">
<h4><a class="toc-backref" href="#id26" role="doc-backlink">Find the shortest path</a><a class="headerlink" href="#find-the-shortest-path" title="Link to this heading">¶</a></h4>
<p>To solve this example <a class="reference internal" href="pgr_dijkstra.html"><span class="doc">pgr_dijkstra</span></a> is used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_dijkstra</span><span class="p">(</span>
  <span class="s1">&#39;SELECT id, source, target, cost FROM wiki&#39;</span><span class="p">,</span>
  <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">false</span><span class="p">);</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">path_seq</span> <span class="o">|</span> <span class="n">start_vid</span> <span class="o">|</span> <span class="n">end_vid</span> <span class="o">|</span> <span class="n">node</span> <span class="o">|</span> <span class="n">edge</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">agg_cost</span>
<span class="o">-----+----------+-----------+---------+------+------+------+----------</span>
   <span class="mi">1</span> <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>       <span class="mi">5</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span>    <span class="mi">9</span> <span class="o">|</span>        <span class="mi">0</span>
   <span class="mi">2</span> <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>       <span class="mi">5</span> <span class="o">|</span>    <span class="mi">3</span> <span class="o">|</span>    <span class="mi">6</span> <span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span>        <span class="mi">9</span>
   <span class="mi">3</span> <span class="o">|</span>        <span class="mi">3</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>       <span class="mi">5</span> <span class="o">|</span>    <span class="mi">6</span> <span class="o">|</span>    <span class="mi">9</span> <span class="o">|</span>    <span class="mi">9</span> <span class="o">|</span>       <span class="mi">11</span>
   <span class="mi">4</span> <span class="o">|</span>        <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>       <span class="mi">5</span> <span class="o">|</span>    <span class="mi">5</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>    <span class="mi">0</span> <span class="o">|</span>       <span class="mi">20</span>
<span class="p">(</span><span class="mi">4</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>To go from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(5\)</span> the path goes thru the following vertices:
<span class="math notranslate nohighlight">\(1 \rightarrow 3 \rightarrow 6 \rightarrow 5\)</span></p>
<div class="graphviz"><img src="_images/graphviz-2be84fbb8166d4e067f5592a16b83c30776ea85c.png" alt="graph G {
 rankdir=&quot;LR&quot;;
 1 [color=&quot;red&quot;];
 5 [color=&quot;green&quot;];
 1 -- 2 [label=&quot;(7)&quot;];
 5 -- 6 [label=&quot;(9)&quot;, color=&quot;blue&quot;];
 1 -- 3 [label=&quot;(9)&quot;, color=&quot;blue&quot;];
 1 -- 6 [label=&quot;(14)&quot;];
 2 -- 3 [label=&quot;(10)&quot;];
 2 -- 4 [label=&quot;(13)&quot;];
 3 -- 4 [label=&quot;(11)&quot;];
 3 -- 6 [label=&quot;(2)&quot;, color=&quot;blue&quot;];
 4 -- 5 [label=&quot;(6)&quot;];
}" class="graphviz" /></div>
</section>
<section id="vertex-information">
<h4><a class="toc-backref" href="#id27" role="doc-backlink">Vertex information</a><a class="headerlink" href="#vertex-information" title="Link to this heading">¶</a></h4>
<p>To obtain the vertices information, use <a class="reference internal" href="pgr_extractVertices.html"><span class="doc">pgr_extractVertices</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span>
<span class="n">FROM</span> <span class="n">pgr_extractVertices</span><span class="p">(</span><span class="s1">&#39;SELECT id, source, target FROM wiki&#39;</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">in_edges</span> <span class="o">|</span> <span class="n">out_edges</span>
<span class="o">----+----------+-----------</span>
  <span class="mi">3</span> <span class="o">|</span> <span class="p">{</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">}</span>    <span class="o">|</span> <span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">}</span>
  <span class="mi">5</span> <span class="o">|</span> <span class="p">{</span><span class="mi">8</span><span class="p">}</span>      <span class="o">|</span> <span class="p">{</span><span class="mi">9</span><span class="p">}</span>
  <span class="mi">4</span> <span class="o">|</span> <span class="p">{</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">}</span>    <span class="o">|</span> <span class="p">{</span><span class="mi">8</span><span class="p">}</span>
  <span class="mi">2</span> <span class="o">|</span> <span class="p">{</span><span class="mi">1</span><span class="p">}</span>      <span class="o">|</span> <span class="p">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">}</span>
  <span class="mi">1</span> <span class="o">|</span>          <span class="o">|</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">}</span>
  <span class="mi">6</span> <span class="o">|</span> <span class="p">{</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">}</span>  <span class="o">|</span>
<span class="p">(</span><span class="mi">6</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
</section>
</section>
</section>
<section id="graphs-with-geometries">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Graphs with geometries</a><a class="headerlink" href="#graphs-with-geometries" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id3">
<ul class="simple">
<li><p><a class="reference internal" href="#create-a-routing-database" id="id28">Create a routing Database</a></p></li>
<li><p><a class="reference internal" href="#load-data" id="id29">Load Data</a></p></li>
<li><p><a class="reference internal" href="#build-a-routing-topology" id="id30">Build a routing topology</a></p></li>
<li><p><a class="reference internal" href="#adjust-costs" id="id31">Adjust costs</a></p>
<ul>
<li><p><a class="reference internal" href="#update-costs-to-length-of-geometry" id="id32">Update costs to length of geometry</a></p></li>
<li><p><a class="reference internal" href="#update-costs-based-on-codes" id="id33">Update costs based on codes</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="create-a-routing-database">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Create a routing Database</a><a class="headerlink" href="#create-a-routing-database" title="Link to this heading">¶</a></h3>
<p>The first step is to create a database and load pgRouting in the database.</p>
<p>Typically create a database for each project.</p>
<p>Once having the database to work in, load your data and build the routing
application in that database.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">createdb</span> <span class="n">sampledata</span>
<span class="n">psql</span> <span class="n">sampledata</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;CREATE EXTENSION pgrouting CASCADE&quot;</span>
</pre></div>
</div>
</section>
<section id="load-data">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Load Data</a><a class="headerlink" href="#load-data" title="Link to this heading">¶</a></h3>
<p>There are several ways to load your data into pgRouting.</p>
<ul class="simple">
<li><p>Manually creating a database.</p>
<ul>
<li><p><a class="reference internal" href="#graphs-without-geometries">Graphs without geometries</a></p></li>
<li><p><a class="reference internal" href="sampledata.html"><span class="doc">Sample Data</span></a>: a small graph used in the documentation examples</p></li>
</ul>
</li>
<li><p>Using <a class="reference external" href="https://workshop.pgrouting.org/latest/en/basic/data.html">osm2pgrouting</a></p></li>
</ul>
<p>There are various open source tools that can help, like:</p>
<dl class="field-list simple">
<dt class="field-odd">shp2pgsql<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>postgresql shapefile loader</p></li>
</ul>
</dd>
<dt class="field-even">ogr2ogr<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p>vector data conversion utility</p></li>
</ul>
</dd>
<dt class="field-odd">osm2pgsql<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>load OSM data into postgresql</p></li>
</ul>
</dd>
</dl>
<p>Please note that these tools will <strong>not</strong> import the data in a structure
compatible with pgRouting and when this happens the topology needs to be
adjusted.</p>
<ul class="simple">
<li><p>Breakup a segments on each segment-segment intersection</p></li>
<li><p>When missing, add columns and assign values to <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>,
<code class="docutils literal notranslate"><span class="pre">cost</span></code>, <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code>.</p></li>
<li><p>Connect a disconnected graph.</p></li>
<li><p>Create the complete graph topology</p></li>
<li><p>Create one or more graphs based on the application to be developed.</p>
<ul>
<li><p>Create a contracted graph for the high speed roads</p></li>
<li><p>Create graphs per state/country</p></li>
</ul>
</li>
</ul>
<p>In few words:</p>
<blockquote>
<div><p>Prepare the graph</p>
</div></blockquote>
<p>What and how to prepare the graph, will depend on the application and/or on the
quality of the data and/or on how close the information is to have a topology
usable by pgRouting and/or some other factors not mentioned.</p>
<p>The steps to prepare the graph involve geometry operations using <a class="reference external" href="https://postgis.net/">PostGIS</a> and some others involve graph operations like
<a class="reference internal" href="pgr_contraction.html"><span class="doc">pgr_contraction</span></a> to contract a graph.</p>
<p>The <a class="reference external" href="https://workshop.pgrouting.org/latest">workshop</a> has a step by step on
how to prepare a graph using Open Street Map data, for a small application.</p>
<p>The use of indexes on the database design in general:</p>
<ul class="simple">
<li><p>Have the geometries indexed.</p></li>
<li><p>Have the identifiers columns indexed.</p></li>
</ul>
<p>Please consult the <a class="reference external" href="https://www.postgresql.org/docs/">PostgreSQL</a>
documentation and the <a class="reference external" href="https://postgis.net/">PostGIS</a> documentation.</p>
</section>
<section id="build-a-routing-topology">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Build a routing topology</a><a class="headerlink" href="#build-a-routing-topology" title="Link to this heading">¶</a></h3>
<p>The basic information to use the majority of the pgRouting functions <code class="docutils literal notranslate"><span class="pre">id,</span>
<span class="pre">source,</span> <span class="pre">target,</span> <span class="pre">cost,</span> <span class="pre">[reverse_cost]</span></code> is what in pgRouting is called the
routing topology.</p>
<p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> is optional but strongly recommended to have in order to reduce
the size of the database due to the size of the geometry columns.
Having said that, in this documentation <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> is used in this
documentation.</p>
<p>When the data comes with geometries and there is no routing topology, then this
step is needed.</p>
<p>All the start and end vertices of the geometries need an identifier that is to
be stored in a <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> columns of the table of the data.
Likewise, <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> need to have the value of traversing the
edge in both directions.</p>
<p>If the columns do not exist they need to be added to the table in question. (see
<a class="reference external" href="https://www.postgresql.org/docs/current/sql-altertable.html">ALTER TABLE</a>)</p>
<p>The function <a class="reference internal" href="pgr_extractVertices.html"><span class="doc">pgr_extractVertices</span></a> is used to create a vertices table
based on the edge identifier and the geometry of the edge of the graph.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">INTO</span> <span class="n">vertices</span>
<span class="n">FROM</span> <span class="n">pgr_extractVertices</span><span class="p">(</span><span class="s1">&#39;SELECT id, geom FROM edges ORDER BY id&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="mi">17</span>
</pre></div>
</div>
<p>Finally using the data stored on the vertices tables the <code class="docutils literal notranslate"><span class="pre">source</span></code> and
<code class="docutils literal notranslate"><span class="pre">target</span></code> are filled up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">source</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">source</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">ST_StartPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">20</span>
<span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">target</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">target</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">ST_EndPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">20</span>
</pre></div>
</div>
<p>Data coming from OSM and using <a class="reference external" href="https://github.com/pgRouting/osm2pgrouting">osm2pgrouting</a> as an import tool, comes with
the routing topology. See an example of using <code class="docutils literal notranslate"><span class="pre">osm2pgrouting</span></code> on the <a class="reference external" href="https://workshop.pgrouting.org/latest/en/basic/data.html">workshop</a>.</p>
</section>
<section id="adjust-costs">
<h3><a class="toc-backref" href="#id31" role="doc-backlink">Adjust costs</a><a class="headerlink" href="#adjust-costs" title="Link to this heading">¶</a></h3>
<p>For this example the <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> values are going to be the
double of the length of the geometry.</p>
<section id="update-costs-to-length-of-geometry">
<h4><a class="toc-backref" href="#id32" role="doc-backlink">Update costs to length of geometry</a><a class="headerlink" href="#update-costs-to-length-of-geometry" title="Link to this heading">¶</a></h4>
<p>Suppose that <code class="docutils literal notranslate"><span class="pre">cost</span></code> and <code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code> columns in the sample data represent:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1\)</span> when the edge exists in the graph</p></li>
<li><p><span class="math notranslate nohighlight">\(-1\)</span> when the edge does not exist in the graph</p></li>
</ul>
<p>Using that information updating to the length of the geometries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">ST_length</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
<span class="n">reverse_cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">reverse_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">ST_length</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
</pre></div>
</div>
<p>Which gives the following results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span> <span class="n">FROM</span> <span class="n">edges</span><span class="p">;</span>
 <span class="nb">id</span> <span class="o">|</span>        <span class="n">cost</span>        <span class="o">|</span>    <span class="n">reverse_cost</span>
<span class="o">----+--------------------+--------------------</span>
  <span class="mi">6</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">7</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">4</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">5</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span>
  <span class="mi">8</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">12</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span>
 <span class="mi">11</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span>
 <span class="mi">10</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">17</span> <span class="o">|</span>     <span class="mf">2.999999999998</span> <span class="o">|</span>     <span class="mf">2.999999999998</span>
 <span class="mi">14</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">18</span> <span class="o">|</span> <span class="mf">3.4000000000000004</span> <span class="o">|</span> <span class="mf">3.4000000000000004</span>
 <span class="mi">13</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span>
 <span class="mi">15</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">16</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">9</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">3</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">1</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
<span class="p">(</span><span class="mi">18</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Note that to be able to follow the documentation examples, everything is based
on the original graph.</p>
<p>Returning to the original data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span>
<span class="n">reverse_cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">reverse_cost</span><span class="p">);</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
</pre></div>
</div>
</section>
<section id="update-costs-based-on-codes">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Update costs based on codes</a><a class="headerlink" href="#update-costs-based-on-codes" title="Link to this heading">¶</a></h4>
<p>Other datasets, can have a column with values like</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FT</span></code> vehicle flow on the direction of the geometry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TF</span></code> vehicle flow opposite of the direction of the geometry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> vehicle flow on both directions</p></li>
</ul>
<p>Preparing a code column for the example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">edges</span> <span class="n">ADD</span> <span class="n">COLUMN</span> <span class="n">direction</span> <span class="n">TEXT</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span>
<span class="n">direction</span> <span class="o">=</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="n">cost</span><span class="o">&gt;</span><span class="mi">0</span> <span class="n">AND</span> <span class="n">reverse_cost</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;B&#39;</span>   <span class="o">/*</span> <span class="n">both</span> <span class="n">ways</span> <span class="o">*/</span>
           <span class="n">WHEN</span> <span class="p">(</span><span class="n">cost</span><span class="o">&gt;</span><span class="mi">0</span> <span class="n">AND</span> <span class="n">reverse_cost</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;FT&#39;</span>  <span class="o">/*</span> <span class="n">direction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">LINESSTRING</span> <span class="o">*/</span>
           <span class="n">WHEN</span> <span class="p">(</span><span class="n">cost</span><span class="o">&lt;</span><span class="mi">0</span> <span class="n">AND</span> <span class="n">reverse_cost</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="n">THEN</span> <span class="s1">&#39;TF&#39;</span>  <span class="o">/*</span> <span class="n">reverse</span> <span class="n">direction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">LINESTRING</span> <span class="o">*/</span>
           <span class="n">ELSE</span> <span class="s1">&#39;&#39;</span> <span class="n">END</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
<span class="o">/*</span> <span class="n">unknown</span> <span class="o">*/</span>
</pre></div>
</div>
<p>Adjusting the costs based on the codes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span> <span class="n">OR</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;FT&#39;</span><span class="p">)</span>
       <span class="n">THEN</span> <span class="n">ST_length</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
       <span class="n">ELSE</span> <span class="o">-</span><span class="mi">1</span> <span class="n">END</span><span class="p">,</span>
<span class="n">reverse_cost</span> <span class="o">=</span> <span class="n">CASE</span> <span class="n">WHEN</span> <span class="p">(</span><span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span> <span class="n">OR</span> <span class="n">direction</span> <span class="o">=</span> <span class="s1">&#39;TF&#39;</span><span class="p">)</span>
       <span class="n">THEN</span> <span class="n">ST_length</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
       <span class="n">ELSE</span> <span class="o">-</span><span class="mi">1</span> <span class="n">END</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
</pre></div>
</div>
<p>Which gives the following results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span> <span class="n">FROM</span> <span class="n">edges</span><span class="p">;</span>
 <span class="nb">id</span> <span class="o">|</span>        <span class="n">cost</span>        <span class="o">|</span>    <span class="n">reverse_cost</span>
<span class="o">----+--------------------+--------------------</span>
  <span class="mi">6</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">7</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">4</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">5</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span>
  <span class="mi">8</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">12</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span>
 <span class="mi">11</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span>
 <span class="mi">10</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">17</span> <span class="o">|</span>     <span class="mf">2.999999999998</span> <span class="o">|</span>     <span class="mf">2.999999999998</span>
 <span class="mi">14</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">18</span> <span class="o">|</span> <span class="mf">3.4000000000000004</span> <span class="o">|</span> <span class="mf">3.4000000000000004</span>
 <span class="mi">13</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span>
 <span class="mi">15</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
 <span class="mi">16</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">9</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">3</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">1</span> <span class="o">|</span>                  <span class="mi">2</span> <span class="o">|</span>                  <span class="mi">2</span>
  <span class="mi">2</span> <span class="o">|</span>                 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>                  <span class="mi">2</span>
<span class="p">(</span><span class="mi">18</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Returning to the original data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">cost</span><span class="p">),</span>
<span class="n">reverse_cost</span> <span class="o">=</span> <span class="n">sign</span><span class="p">(</span><span class="n">reverse_cost</span><span class="p">);</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">edges</span> <span class="n">DROP</span> <span class="n">COLUMN</span> <span class="n">direction</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="check-the-routing-topology">
<h2><a class="toc-backref" href="#id11" role="doc-backlink">Check the Routing Topology</a><a class="headerlink" href="#check-the-routing-topology" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id4">
<ul class="simple">
<li><p><a class="reference internal" href="#crossing-edges" id="id34">Crossing edges</a></p></li>
<li><p><a class="reference internal" href="#fixing-an-intersection" id="id35">Fixing an intersection</a></p></li>
<li><p><a class="reference internal" href="#disconnected-graphs" id="id36">Disconnected graphs</a></p>
<ul>
<li><p><a class="reference internal" href="#prepare-storage-for-connection-information" id="id37">Prepare storage for connection information</a></p></li>
<li><p><a class="reference internal" href="#save-the-vertices-connection-information" id="id38">Save the vertices connection information</a></p></li>
<li><p><a class="reference internal" href="#save-the-edges-connection-information" id="id39">Save the edges connection information</a></p></li>
<li><p><a class="reference internal" href="#get-the-closest-vertex" id="id40">Get the closest vertex</a></p></li>
<li><p><a class="reference internal" href="#connecting-components" id="id41">Connecting components</a></p></li>
<li><p><a class="reference internal" href="#checking-components" id="id42">Checking components</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#contraction-of-a-graph" id="id43">Contraction of a graph</a></p>
<ul>
<li><p><a class="reference internal" href="#dead-ends" id="id44">Dead ends</a></p></li>
<li><p><a class="reference internal" href="#linear-edges" id="id45">Linear edges</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>There are lots of possible problems in a graph.</p>
<ul class="simple">
<li><p>The data used may not have been designed with routing in mind.</p></li>
<li><p>A graph has some very specific requirements.</p></li>
<li><p>The graph is disconnected.</p></li>
<li><p>There are unwanted intersections.</p></li>
<li><p>The graph is too large and needs to be contracted.</p></li>
<li><p>A sub graph is needed for the application.</p></li>
<li><p>and many other problems that the pgRouting user, that is the application
developer might encounter.</p></li>
</ul>
<section id="crossing-edges">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Crossing edges</a><a class="headerlink" href="#crossing-edges" title="Link to this heading">¶</a></h3>
<p>To get the crossing edges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">a</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">id</span>
<span class="n">FROM</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">a</span><span class="p">,</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">b</span>
<span class="n">WHERE</span> <span class="n">a</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="n">b</span><span class="o">.</span><span class="n">id</span> <span class="n">AND</span> <span class="n">st_crosses</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">geom</span><span class="p">);</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="nb">id</span>
<span class="o">----+----</span>
 <span class="mi">13</span> <span class="o">|</span> <span class="mi">18</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

</pre></div>
</div>
<figure class="align-default">
<img alt="_images/crossing_edges.png" src="_images/crossing_edges.png" />
</figure>
<p>That information is correct, for example, when in terms of vehicles, is it a
tunnel or bridge crossing over another road.</p>
<p>It might be incorrect, for example:</p>
<ol class="arabic simple">
<li><p>When it is actually an intersection of roads, where vehicles can make turns.</p></li>
<li><p>When in terms of electrical lines, the electrical line is able to switch
roads even on a tunnel or bridge.</p></li>
</ol>
<p>When it is incorrect, it needs fixing:</p>
<ol class="arabic simple">
<li><p>For vehicles and pedestrians</p>
<ul class="simple">
<li><p>If the data comes from OSM and was imported to the database using
<code class="docutils literal notranslate"><span class="pre">osm2pgrouting</span></code>, the fix needs to be done in the <a class="reference external" href="https://www.openstreetmap.org">OSM portal</a> and the data imported again.</p></li>
<li><p>In general when the data comes from a supplier that has the data prepared
for routing vehicles, and there is a problem, the data is to be fixed from
the supplier</p></li>
</ul>
</li>
<li><p>For very specific applications</p>
<ul class="simple">
<li><p>The data is correct when from the point of view of routing vehicles or
pedestrians.</p></li>
<li><p>The data needs a local fix for the specific application.</p></li>
</ul>
</li>
</ol>
<p>Once analyzed one by one the crossings, for the ones that need a local fix,
the edges need to be <a class="reference external" href="https://postgis.net/docs/ST_Split.html">split</a>.</p>
<p>The new edges need to be added to the edges table, the rest of the attributes
need to be updated in the new edges, the old edges need to be
removed and the routing topology needs to be updated.</p>
</section>
<section id="fixing-an-intersection">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Fixing an intersection</a><a class="headerlink" href="#fixing-an-intersection" title="Link to this heading">¶</a></h3>
<p>In this example the original edge table will be used to store the additional
geometries.</p>
<p>Create the topology for the data in <a class="reference internal" href="sampledata.html"><span class="doc">Sample Data</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">INTO</span> <span class="n">vertices</span>
<span class="n">FROM</span> <span class="n">pgr_extractVertices</span><span class="p">(</span><span class="s1">&#39;SELECT id, geom FROM edges ORDER BY id&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="mi">17</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">source</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">source</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">ST_StartPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
<span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">target</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">target</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">ST_EndPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
</pre></div>
</div>
<p>Routing from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(2\)</span> gives no solution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">pgr_dijkstra</span><span class="p">(</span><span class="s1">&#39;SELECT id, source, target, cost, reverse_cost FROM edges&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">path_seq</span> <span class="o">|</span> <span class="n">start_vid</span> <span class="o">|</span> <span class="n">end_vid</span> <span class="o">|</span> <span class="n">node</span> <span class="o">|</span> <span class="n">edge</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">agg_cost</span>
<span class="o">-----+----------+-----------+---------+------+------+------+----------</span>
<span class="p">(</span><span class="mi">0</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Analyze the network for intersections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span>
  <span class="n">e1</span><span class="o">.</span><span class="n">id</span> <span class="n">id1</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">id</span> <span class="n">id2</span><span class="p">,</span>
  <span class="n">ST_AsText</span><span class="p">(</span><span class="n">ST_Intersection</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">geom</span><span class="p">))</span> <span class="n">AS</span> <span class="n">point</span>
<span class="n">FROM</span> <span class="n">edges</span> <span class="n">e1</span><span class="p">,</span> <span class="n">edges</span> <span class="n">e2</span>
<span class="n">WHERE</span> <span class="n">e1</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="n">e2</span><span class="o">.</span><span class="n">id</span> <span class="n">AND</span> <span class="n">ST_Crosses</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">geom</span><span class="p">,</span> <span class="n">e2</span><span class="o">.</span><span class="n">geom</span><span class="p">);</span>
 <span class="n">id1</span> <span class="o">|</span> <span class="n">id2</span> <span class="o">|</span>    <span class="n">point</span>
<span class="o">-----+-----+--------------</span>
  <span class="mi">13</span> <span class="o">|</span>  <span class="mi">18</span> <span class="o">|</span> <span class="n">POINT</span><span class="p">(</span><span class="mf">3.5</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span> <span class="n">row</span><span class="p">)</span>

</pre></div>
</div>
<p>The analysis tell us that the network has an intersection.</p>
<p>Additional columns to control the origin of the segments.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">edges</span> <span class="n">ADD</span> <span class="n">old_id</span> <span class="n">BIGINT</span><span class="p">,</span> <span class="n">ADD</span> <span class="n">sub_id</span> <span class="n">BIGINT</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
</pre></div>
</div>
<p>Calling <a class="reference internal" href="pgr_separateCrossing.html"><span class="doc">pgr_separateCrossing</span></a> and adding the new segments to the edges table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">edges</span> <span class="p">(</span><span class="n">old_id</span><span class="p">,</span> <span class="n">sub_id</span><span class="p">,</span> <span class="n">geom</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">sub_id</span><span class="p">,</span> <span class="n">geom</span>
<span class="n">FROM</span> <span class="n">pgr_separateCrossing</span><span class="p">(</span><span class="s1">&#39;SELECT id, geom FROM edges&#39;</span><span class="p">);</span>
<span class="n">INSERT</span> <span class="mi">0</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Update the cost and reverse_cost values.</p>
<p>In this example the costs are based on the length of the geometry and the
directionality is kept using the <code class="docutils literal notranslate"><span class="pre">sign</span></code> function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WITH</span>
<span class="n">costs</span> <span class="n">AS</span> <span class="p">(</span>
  <span class="n">SELECT</span> <span class="n">e2</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">sign</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">ST_Length</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="n">AS</span> <span class="n">cost</span><span class="p">,</span>
  <span class="n">sign</span><span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">reverse_cost</span><span class="p">)</span> <span class="o">*</span> <span class="n">ST_Length</span><span class="p">(</span><span class="n">e2</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="n">AS</span> <span class="n">reverse_cost</span>
  <span class="n">FROM</span> <span class="n">edges</span> <span class="n">e1</span> <span class="n">JOIN</span> <span class="n">edges</span> <span class="n">e2</span> <span class="n">ON</span> <span class="p">(</span><span class="n">e1</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">e2</span><span class="o">.</span><span class="n">old_id</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">e</span>
<span class="n">SET</span> <span class="p">(</span><span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">cost</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">reverse_cost</span><span class="p">)</span>
<span class="n">FROM</span> <span class="n">costs</span> <span class="n">AS</span> <span class="n">c</span> <span class="n">WHERE</span> <span class="n">e</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">id</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">4</span>
</pre></div>
</div>
<p class="rubric">Update the topology</p>
<p>Insert the intersections as new vertices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">WITH</span>
<span class="n">new_vertex</span> <span class="n">AS</span> <span class="p">(</span>
  <span class="n">SELECT</span> <span class="n">ev</span><span class="o">.*</span>
  <span class="n">FROM</span> <span class="n">pgr_extractVertices</span><span class="p">(</span><span class="s1">&#39;SELECT id, geom FROM edges WHERE old_id IS NOT NULL&#39;</span><span class="p">)</span> <span class="n">ev</span>
  <span class="n">LEFT</span> <span class="n">JOIN</span> <span class="n">vertices</span> <span class="n">v</span> <span class="n">using</span><span class="p">(</span><span class="n">geom</span><span class="p">)</span>
  <span class="n">WHERE</span> <span class="n">v</span> <span class="n">IS</span> <span class="n">NULL</span><span class="p">)</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">vertices</span> <span class="p">(</span><span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">geom</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">in_edges</span><span class="p">,</span> <span class="n">out_edges</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">geom</span> <span class="n">FROM</span> <span class="n">new_vertex</span><span class="p">;</span>
<span class="n">INSERT</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Update source and target information on the edges table.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">source</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">source</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">source</span> <span class="n">IS</span> <span class="n">NULL</span> <span class="n">AND</span> <span class="n">ST_StartPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">4</span>
<span class="o">/*</span> <span class="o">--</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">target</span> <span class="n">information</span> <span class="o">*/</span>
<span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">AS</span> <span class="n">e</span>
<span class="n">SET</span> <span class="n">target</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">y</span>
<span class="n">FROM</span> <span class="n">vertices</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">target</span> <span class="n">IS</span> <span class="n">NULL</span> <span class="n">AND</span> <span class="n">ST_EndPoint</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">geom</span><span class="p">)</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">geom</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Routing from <span class="math notranslate nohighlight">\(1\)</span> to <span class="math notranslate nohighlight">\(18\)</span> gives a solution.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">pgr_dijkstra</span><span class="p">(</span><span class="s1">&#39;SELECT id, source, target, cost, reverse_cost FROM edges&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">);</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">path_seq</span> <span class="o">|</span> <span class="n">start_vid</span> <span class="o">|</span> <span class="n">end_vid</span> <span class="o">|</span> <span class="n">node</span> <span class="o">|</span> <span class="n">edge</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">agg_cost</span>
<span class="o">-----+----------+-----------+---------+------+------+------+----------</span>
   <span class="mi">1</span> <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>    <span class="mi">6</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>        <span class="mi">0</span>
   <span class="mi">2</span> <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>    <span class="mi">3</span> <span class="o">|</span>    <span class="mi">7</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>        <span class="mi">1</span>
   <span class="mi">3</span> <span class="o">|</span>        <span class="mi">3</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>    <span class="mi">7</span> <span class="o">|</span>   <span class="mi">10</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>        <span class="mi">2</span>
   <span class="mi">4</span> <span class="o">|</span>        <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>    <span class="mi">8</span> <span class="o">|</span>   <span class="mi">12</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>        <span class="mi">3</span>
   <span class="mi">5</span> <span class="o">|</span>        <span class="mi">5</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>   <span class="mi">12</span> <span class="o">|</span>   <span class="mi">19</span> <span class="o">|</span>  <span class="mf">0.5</span> <span class="o">|</span>        <span class="mi">4</span>
   <span class="mi">6</span> <span class="o">|</span>        <span class="mi">6</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>      <span class="mi">18</span> <span class="o">|</span>   <span class="mi">18</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>    <span class="mi">0</span> <span class="o">|</span>      <span class="mf">4.5</span>
<span class="p">(</span><span class="mi">6</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
</section>
<section id="disconnected-graphs">
<h3><a class="toc-backref" href="#id36" role="doc-backlink">Disconnected graphs</a><a class="headerlink" href="#disconnected-graphs" title="Link to this heading">¶</a></h3>
<p>To get the graph connectivity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_connectedComponents</span><span class="p">(</span>
  <span class="s1">&#39;SELECT id, source, target, cost, reverse_cost FROM edges&#39;</span>
<span class="p">);</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">component</span> <span class="o">|</span> <span class="n">node</span>
<span class="o">-----+-----------+------</span>
   <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">3</span>
   <span class="mi">3</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">5</span>
   <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">6</span>
   <span class="mi">5</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">7</span>
   <span class="mi">6</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">8</span>
   <span class="mi">7</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">9</span>
   <span class="mi">8</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">10</span>
   <span class="mi">9</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">11</span>
  <span class="mi">10</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">12</span>
  <span class="mi">11</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">15</span>
  <span class="mi">12</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">16</span>
  <span class="mi">13</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">17</span>
  <span class="mi">14</span> <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>    <span class="mi">2</span>
  <span class="mi">15</span> <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>    <span class="mi">4</span>
  <span class="mi">16</span> <span class="o">|</span>        <span class="mi">13</span> <span class="o">|</span>   <span class="mi">13</span>
  <span class="mi">17</span> <span class="o">|</span>        <span class="mi">13</span> <span class="o">|</span>   <span class="mi">14</span>
<span class="p">(</span><span class="mi">17</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>In this example, the component <span class="math notranslate nohighlight">\(2\)</span> consists of vertices <span class="math notranslate nohighlight">\(\{2, 4\}\)</span>
and both vertices are also part of the dead end result set.</p>
<p>This graph needs to be connected.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the original graph of this documentation, there would be 3 components as
the crossing edge in this graph is a different component.</p>
</div>
<section id="prepare-storage-for-connection-information">
<h4><a class="toc-backref" href="#id37" role="doc-backlink">Prepare storage for connection information</a><a class="headerlink" href="#prepare-storage-for-connection-information" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">vertices</span> <span class="n">ADD</span> <span class="n">COLUMN</span> <span class="n">component</span> <span class="n">BIGINT</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
<span class="n">ALTER</span> <span class="n">TABLE</span> <span class="n">edges</span> <span class="n">ADD</span> <span class="n">COLUMN</span> <span class="n">component</span> <span class="n">BIGINT</span><span class="p">;</span>
<span class="n">ALTER</span> <span class="n">TABLE</span>
</pre></div>
</div>
</section>
<section id="save-the-vertices-connection-information">
<h4><a class="toc-backref" href="#id38" role="doc-backlink">Save the vertices connection information</a><a class="headerlink" href="#save-the-vertices-connection-information" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">vertices</span> <span class="n">SET</span> <span class="n">component</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">component</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_connectedComponents</span><span class="p">(</span>
  <span class="s1">&#39;SELECT id, source, target, cost, reverse_cost FROM edges&#39;</span>
<span class="p">))</span> <span class="n">AS</span> <span class="n">c</span>
<span class="n">WHERE</span> <span class="nb">id</span> <span class="o">=</span> <span class="n">node</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">17</span>
</pre></div>
</div>
</section>
<section id="save-the-edges-connection-information">
<h4><a class="toc-backref" href="#id39" role="doc-backlink">Save the edges connection information</a><a class="headerlink" href="#save-the-edges-connection-information" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="n">edges</span> <span class="n">SET</span> <span class="n">component</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">component</span>
<span class="n">FROM</span> <span class="p">(</span><span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">component</span> <span class="n">FROM</span> <span class="n">vertices</span><span class="p">)</span> <span class="n">AS</span> <span class="n">v</span>
<span class="n">WHERE</span> <span class="n">source</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">id</span><span class="p">;</span>
<span class="n">UPDATE</span> <span class="mi">18</span>
</pre></div>
</div>
</section>
<section id="get-the-closest-vertex">
<h4><a class="toc-backref" href="#id40" role="doc-backlink">Get the closest vertex</a><a class="headerlink" href="#get-the-closest-vertex" title="Link to this heading">¶</a></h4>
<p>Using <a class="reference internal" href="pgr_findCloseEdges.html"><span class="doc">pgr_findCloseEdges</span></a> the closest vertex to component <span class="math notranslate nohighlight">\(1\)</span> is
vertex <span class="math notranslate nohighlight">\(4\)</span>. And the closest edge to vertex <span class="math notranslate nohighlight">\(4\)</span> is edge <span class="math notranslate nohighlight">\(14\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT edge_id, fraction, ST_AsText(edge) AS edge, id AS closest_vertex
FROM pgr_findCloseEdges(
  $$SELECT id, geom FROM edges WHERE component = 1$$,
  (SELECT array_agg(geom) FROM vertices WHERE component = 2),
  2) JOIN vertices USING (geom) ORDER BY distance LIMIT 1;
 edge_id | fraction |                 edge                 | closest_vertex
---------+----------+--------------------------------------+----------------
      14 |      0.5 | LINESTRING(1.999999999999 3.5,2 3.5) |              4
(1 row)

</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">edge</span></code> can be used to connect the components, using the <code class="docutils literal notranslate"><span class="pre">fraction</span></code>
information about the edge <span class="math notranslate nohighlight">\(14\)</span> to split the connecting edge.</p>
</section>
<section id="connecting-components">
<h4><a class="toc-backref" href="#id41" role="doc-backlink">Connecting components</a><a class="headerlink" href="#connecting-components" title="Link to this heading">¶</a></h4>
<p>There are three basic ways to connect the components</p>
<ul class="simple">
<li><p>From the vertex to the starting point of the edge</p></li>
<li><p>From the vertex to the ending point of the edge</p></li>
<li><p>From the vertex to the closest vertex on the edge</p>
<ul>
<li><p>This solution requires the edge to be split.</p></li>
</ul>
</li>
</ul>
<p>The following query shows the three ways to connect the components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>WITH
info AS (
  SELECT
    edge_id, fraction, side, distance, ce.geom, edge, v.id AS closest,
    source, target, capacity, reverse_capacity, e.geom AS e_geom
  FROM pgr_findCloseEdges(
    $$SELECT id, geom FROM edges WHERE component = 1$$,
    (SELECT array_agg(geom) FROM vertices WHERE component = 2),
    2) AS ce
  JOIN vertices AS v USING (geom)
  JOIN edges AS e ON (edge_id = e.id)
  ORDER BY distance LIMIT 1),
three_options AS (
  SELECT
    closest AS source, target, 0 AS cost, 0 AS reverse_cost,
    capacity, reverse_capacity,
    ST_X(geom) AS x1, ST_Y(geom) AS y1,
    ST_X(ST_EndPoint(e_geom)) AS x2, ST_Y(ST_EndPoint(e_geom)) AS y2,
    ST_MakeLine(geom, ST_EndPoint(e_geom)) AS geom
  FROM info
  UNION
  SELECT closest, source, 0, 0, capacity, reverse_capacity,
    ST_X(geom) AS x1, ST_Y(geom) AS y1,
    ST_X(ST_StartPoint(e_geom)) AS x2, ST_Y(ST_StartPoint(e_geom)) AS y2,
    ST_MakeLine(info.geom, ST_StartPoint(e_geom))
  FROM info
  /*
  UNION
  -- This option requires splitting the edge
  SELECT closest, NULL, 0, 0, capacity, reverse_capacity,
    ST_X(geom) AS x1, ST_Y(geom) AS y1,
    ST_X(ST_EndPoint(edge)) AS x2, ST_Y(ST_EndPoint(edge)) AS y2,
    edge
  FROM info */
  )
INSERT INTO edges
  (source, target,
    cost, reverse_cost,
    capacity, reverse_capacity,
    x1, y1, x2, y2,
    geom)
(SELECT
    source, target, cost, reverse_cost, capacity, reverse_capacity,
    x1, y1, x2, y2, geom
  FROM three_options);
INSERT 0 2
</pre></div>
</div>
</section>
<section id="checking-components">
<h4><a class="toc-backref" href="#id42" role="doc-backlink">Checking components</a><a class="headerlink" href="#checking-components" title="Link to this heading">¶</a></h4>
<p>Ignoring the edge that requires further work. The graph is now fully connected
as there is only one component.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">pgr_connectedComponents</span><span class="p">(</span>
  <span class="s1">&#39;SELECT id, source, target, cost, reverse_cost FROM edges&#39;</span>
<span class="p">);</span>
 <span class="n">seq</span> <span class="o">|</span> <span class="n">component</span> <span class="o">|</span> <span class="n">node</span>
<span class="o">-----+-----------+------</span>
   <span class="mi">1</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">1</span>
   <span class="mi">2</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">2</span>
   <span class="mi">3</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">3</span>
   <span class="mi">4</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">4</span>
   <span class="mi">5</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">5</span>
   <span class="mi">6</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">6</span>
   <span class="mi">7</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">7</span>
   <span class="mi">8</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">8</span>
   <span class="mi">9</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">9</span>
  <span class="mi">10</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">10</span>
  <span class="mi">11</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">11</span>
  <span class="mi">12</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">12</span>
  <span class="mi">13</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">15</span>
  <span class="mi">14</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">16</span>
  <span class="mi">15</span> <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>   <span class="mi">17</span>
  <span class="mi">16</span> <span class="o">|</span>        <span class="mi">13</span> <span class="o">|</span>   <span class="mi">13</span>
  <span class="mi">17</span> <span class="o">|</span>        <span class="mi">13</span> <span class="o">|</span>   <span class="mi">14</span>
<span class="p">(</span><span class="mi">17</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
</section>
</section>
<section id="contraction-of-a-graph">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Contraction of a graph</a><a class="headerlink" href="#contraction-of-a-graph" title="Link to this heading">¶</a></h3>
<p>The graph can be reduced in size using <a class="reference internal" href="contraction-family.html"><span class="doc">Contraction - Family of functions</span></a></p>
<p>When to contract will depend on the size of the graph, processing times,
correctness of the data, on the final application, or any other factor not
mentioned.</p>
<p>A fairly good method of finding out if contraction can be useful is because of
the number of dead ends and/or the number of linear edges.</p>
<p>A complete method on how to contract and how to use the contracted graph is
described on <a class="reference internal" href="contraction-family.html"><span class="doc">Contraction - Family of functions</span></a></p>
<section id="dead-ends">
<h4><a class="toc-backref" href="#id44" role="doc-backlink">Dead ends</a><a class="headerlink" href="#dead-ends" title="Link to this heading">¶</a></h4>
<p>To get the dead ends:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span> <span class="n">FROM</span> <span class="n">vertices</span>
<span class="n">WHERE</span> <span class="n">array_length</span><span class="p">(</span><span class="n">in_edges</span> <span class="o">||</span> <span class="n">out_edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
 <span class="nb">id</span>
<span class="o">----</span>
  <span class="mi">1</span>
  <span class="mi">5</span>
  <span class="mi">9</span>
  <span class="mi">2</span>
  <span class="mi">4</span>
 <span class="mi">13</span>
 <span class="mi">14</span>
<span class="p">(</span><span class="mi">7</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>A dead end happens when</p>
<ul class="simple">
<li><p>The vertex is the limit of a cul-de-sac, a no-through road or a no-exit
road.</p></li>
<li><p>The vertex is on the limit of the imported graph.</p>
<ul>
<li><p>If a larger graph is imported then the vertex might not be a dead end</p></li>
</ul>
</li>
</ul>
<p>Node <span class="math notranslate nohighlight">\(4\)</span>, is a dead end on the query, even that it visually looks like an
end point of 3 edges.</p>
<a class="reference internal image-reference" href="_images/Fig1-originalData.png"><img alt="_images/Fig1-originalData.png" src="_images/Fig1-originalData.png" style="width: 190.20000000000002px; height: 173.20000000000002px;" />
</a>
<p class="rubric">Is node <span class="math notranslate nohighlight">\(4\)</span> a dead end or not?</p>
<div class="graphviz"><img src="_images/graphviz-0efc1c6f9c1a1176ac42aaa8de0be1e9186f8539.png" alt="graph G {
  1,2,4,5,9,13,14 [shape=circle;style=filled;color=lightgreen;fontsize=8;width=0.3;fixedsize=true];
  3,6,7,8,10,11,12,15,16,17 [shape=circle;style=filled;color=cyan;fontsize=8;width=0.3;fixedsize=true];

  5 -- 6 [label=&quot;1&quot;,fontsize=8];     6 -- 10 [label=&quot;2&quot;,fontsize=8];
  10 -- 15 [label=&quot;3&quot;,fontsize=8];   6 -- 7 [label=&quot;4&quot;,fontsize=8];
  10 -- 11 [label=&quot;5&quot;,fontsize=8];   1 -- 3 [label=&quot;6&quot;,fontsize=8];
  3 -- 7 [label=&quot;7&quot;,fontsize=8];     7 -- 11 [label=&quot;8&quot;,fontsize=8];
  11 -- 16 [label=&quot;9&quot;,fontsize=8];   7 -- 8 [label=&quot;10&quot;,fontsize=8];
  11 -- 12 [label=&quot;11&quot;,fontsize=8];  8 -- 12 [label=&quot;12&quot;,fontsize=8];
  12 -- 17 [label=&quot;13&quot;,fontsize=8];  8 -- 9 [label=&quot;&quot;,fontsize=8];
  16 -- 17 [label=&quot;15&quot;,fontsize=8]; 15 -- 16 [label=&quot;16&quot;,fontsize=8];
  2 -- 4 [label=&quot;17&quot;,fontsize=8];   13 -- 14 [label=&quot;18&quot;,fontsize=8];

  1 [pos=&quot;0,2!&quot;];       2 [pos=&quot;0.5,3.5!&quot;];
  3 [pos=&quot;1,2!&quot;];       4 [pos=&quot;2,3.5!&quot;];
  5 [pos=&quot;2,0!&quot;];       6 [pos=&quot;2,1!&quot;];
  7 [pos=&quot;2,2!&quot;];       8 [pos=&quot;2,3!&quot;];
  9 [pos=&quot;2,4!&quot;];      10 [pos=&quot;3,1!&quot;];
  11 [pos=&quot;3,2!&quot;];     12 [pos=&quot;3,3!&quot;];
  13 [pos=&quot;3.5,2.3!&quot;]; 14 [pos=&quot;3.5,4!&quot;];
  15 [pos=&quot;4,1!&quot;];     16 [pos=&quot;4,2!&quot;];
  17 [pos=&quot;4,3!&quot;];
}" class="graphviz" /></div>
<p>The answer to that question will depend on the application.</p>
<ul class="simple">
<li><p>Is there such a small curb:</p>
<ul>
<li><p>That does not allow a vehicle to use that visual intersection?</p></li>
<li><p>Is the application for pedestrians and therefore the pedestrian can easily
walk on the small curb?</p></li>
<li><p>Is the application for the electricity and the electrical lines than can
easily be extended on top of the small curb?</p></li>
</ul>
</li>
<li><p>Is there a big cliff and from eagles view look like the dead end is close to
the segment?</p></li>
</ul>
<p>Depending on the answer, modification of the data might be needed.</p>
<p>When there are many dead ends, to speed up processing, the <a class="reference internal" href="contraction-family.html"><span class="doc">Contraction - Family of functions</span></a>
functions can be used to contract the graph.</p>
</section>
<section id="linear-edges">
<h4><a class="toc-backref" href="#id45" role="doc-backlink">Linear edges</a><a class="headerlink" href="#linear-edges" title="Link to this heading">¶</a></h4>
<p>To get the linear edges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span> <span class="n">FROM</span> <span class="n">vertices</span>
<span class="n">WHERE</span> <span class="n">array_length</span><span class="p">(</span><span class="n">in_edges</span> <span class="o">||</span> <span class="n">out_edges</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
 <span class="nb">id</span>
<span class="o">----</span>
  <span class="mi">3</span>
 <span class="mi">15</span>
 <span class="mi">17</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<div class="graphviz"><img src="_images/graphviz-fcaa0541303f92371c3cf508089a4be8712de558.png" alt="graph G {
  3,15,17 [shape=circle;style=filled;color=lightgreen;fontsize=8;width=0.3;fixedsize=true];
  1,2,4,5,6,7,8,9,10,11,12,13,14,16 [shape=circle;style=filled;color=cyan;fontsize=8;width=0.3;fixedsize=true];

  5 -- 6 [label=&quot;1&quot;,fontsize=8];     6 -- 10 [label=&quot;2&quot;,fontsize=8];
  10 -- 15 [label=&quot;3&quot;,fontsize=8];   6 -- 7 [label=&quot;4&quot;,fontsize=8];
  10 -- 11 [label=&quot;5&quot;,fontsize=8];   1 -- 3 [label=&quot;6&quot;,fontsize=8];
  3 -- 7 [label=&quot;7&quot;,fontsize=8];     7 -- 11 [label=&quot;8&quot;,fontsize=8];
  11 -- 16 [label=&quot;9&quot;,fontsize=8];   7 -- 8 [label=&quot;10&quot;,fontsize=8];
  11 -- 12 [label=&quot;11&quot;,fontsize=8];  8 -- 12 [label=&quot;12&quot;,fontsize=8];
  12 -- 17 [label=&quot;13&quot;,fontsize=8];  8 -- 9 [label=&quot;&quot;,fontsize=8];
  16 -- 17 [label=&quot;15&quot;,fontsize=8]; 15 -- 16 [label=&quot;16&quot;,fontsize=8];
  2 -- 4 [label=&quot;17&quot;,fontsize=8];   13 -- 14 [label=&quot;18&quot;,fontsize=8];

  1 [pos=&quot;0,2!&quot;];       2 [pos=&quot;0.5,3.5!&quot;];
  3 [pos=&quot;1,2!&quot;];       4 [pos=&quot;2,3.5!&quot;];
  5 [pos=&quot;2,0!&quot;];       6 [pos=&quot;2,1!&quot;];
  7 [pos=&quot;2,2!&quot;];       8 [pos=&quot;2,3!&quot;];
  9 [pos=&quot;2,4!&quot;];      10 [pos=&quot;3,1!&quot;];
  11 [pos=&quot;3,2!&quot;];     12 [pos=&quot;3,3!&quot;];
  13 [pos=&quot;3.5,2.3!&quot;]; 14 [pos=&quot;3.5,4!&quot;];
  15 [pos=&quot;4,1!&quot;];     16 [pos=&quot;4,2!&quot;];
  17 [pos=&quot;4,3!&quot;];
}" class="graphviz" /></div>
<p>These linear vertices are correct, for example, when those the vertices are speed
bumps, stop signals and the application is taking them into account.</p>
<p>When there are many linear vertices, that need not to be taken into account, to
speed up the processing, the <a class="reference internal" href="contraction-family.html"><span class="doc">Contraction - Family of functions</span></a> functions can be used to
contract the problem.</p>
</section>
</section>
</section>
<section id="function-s-structure">
<h2><a class="toc-backref" href="#id12" role="doc-backlink">Function’s structure</a><a class="headerlink" href="#function-s-structure" title="Link to this heading">¶</a></h2>
<p>Once the graph preparation work has been done above, it is time to use a</p>
<p>The general form of a pgRouting function call is:</p>
<div class="signatures admonition">
<p class="admonition-title"></p>
<p>pgr_&lt;name&gt;(<a class="reference internal" href="#inner-queries">Inner queries</a>, <strong>parameters</strong>, [ <code class="docutils literal notranslate"><span class="pre">Optional</span> <span class="pre">parameters</span></code>)</p>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#inner-queries">Inner queries</a>: Are compulsory parameters that are <code class="docutils literal notranslate"><span class="pre">TEXT</span></code> strings
containing SQL queries.</p></li>
<li><p><strong>parameters</strong>: Additional compulsory parameters needed by the function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Optional</span> <span class="pre">parameters</span></code>: Are non compulsory <strong>named</strong> parameters that have a
default value when omitted.</p></li>
</ul>
<p>The compulsory parameters are positional parameters, the optional parameters are
named parameters.</p>
<p>For example, for this <a class="reference internal" href="pgr_dijkstra.html"><span class="doc">pgr_dijkstra</span></a> signature:</p>
<div class="signatures admonition">
<p class="admonition-title"></p>
<p>pgr_dijkstra(<a class="reference internal" href="#edges-sql">Edges SQL</a>, <strong>start vids</strong>, <strong>end vids</strong>, [<code class="docutils literal notranslate"><span class="pre">directed</span></code>])</p>
</div>
<ul class="simple">
<li><p><a class="reference internal" href="#edges-sql">Edges SQL</a>:</p>
<ul>
<li><p>Is the first parameter.</p></li>
<li><p>It is compulsory.</p></li>
<li><p>It is an inner query.</p></li>
<li><p>It has no name, so <strong>Edges SQL</strong> gives an idea of what kind of inner query
needs to be used</p></li>
</ul>
</li>
<li><p><strong>start vid</strong>:</p>
<ul>
<li><p>Is the second parameter.</p></li>
<li><p>It is compulsory.</p></li>
<li><p>It has no name, so <strong>start vid</strong> gives an idea of what the second
parameter’s value should contain.</p></li>
</ul>
</li>
<li><p><strong>end vid</strong></p>
<ul>
<li><p>Is the third parameter.</p></li>
<li><p>It is compulsory.</p></li>
<li><p>It has no name, so <strong>end vid</strong> gives an idea of what the third
parameter’s value should contain</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">directed</span></code></p>
<ul>
<li><p>Is the fourth parameter.</p></li>
<li><p>It is optional.</p></li>
<li><p>It has a name.</p></li>
</ul>
</li>
</ul>
<p>The full description of the parameters are found on the <a class="reference internal" href="#parameters">Parameters</a> section of
each function.</p>
</section>
<section id="function-s-overloads">
<h2><a class="toc-backref" href="#id13" role="doc-backlink">Function’s overloads</a><a class="headerlink" href="#function-s-overloads" title="Link to this heading">¶</a></h2>
<p>A function might have different overloads. The most common are called:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#one-to-one">One to One</a></p></li>
<li><p><a class="reference internal" href="#one-to-many">One to Many</a></p></li>
<li><p><a class="reference internal" href="#many-to-one">Many to One</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
<li><p><a class="reference internal" href="#combinations">Combinations</a></p></li>
</ul>
<p>Depending on the overload the parameters types change.</p>
<ul class="simple">
<li><p><strong>One</strong>: <strong>ANY-INTEGER</strong></p></li>
<li><p><strong>Many</strong>: <code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></li>
</ul>
<p>Depending of the function the overloads may vary. But the concept of parameter
type change remains the same.</p>
<section id="one-to-one">
<h3>One to One<a class="headerlink" href="#one-to-one" title="Link to this heading">¶</a></h3>
<p>When routing from:</p>
<ul class="simple">
<li><p>From <strong>one</strong> starting vertex</p></li>
<li><p>to <strong>one</strong> ending vertex</p></li>
</ul>
</section>
<section id="one-to-many">
<h3>One to Many<a class="headerlink" href="#one-to-many" title="Link to this heading">¶</a></h3>
<p>When routing from:</p>
<ul class="simple">
<li><p>From <strong>one</strong> starting vertex</p></li>
<li><p>to <strong>many</strong> ending vertices</p></li>
</ul>
</section>
<section id="many-to-one">
<h3>Many to One<a class="headerlink" href="#many-to-one" title="Link to this heading">¶</a></h3>
<p>When routing from:</p>
<ul class="simple">
<li><p>From <strong>many</strong> starting vertices</p></li>
<li><p>to <strong>one</strong> ending vertex</p></li>
</ul>
</section>
<section id="many-to-many">
<h3>Many to Many<a class="headerlink" href="#many-to-many" title="Link to this heading">¶</a></h3>
<p>When routing from:</p>
<ul class="simple">
<li><p>From <strong>many</strong> starting vertices</p></li>
<li><p>to <strong>many</strong> ending vertices</p></li>
</ul>
</section>
<section id="combinations">
<h3>Combinations<a class="headerlink" href="#combinations" title="Link to this heading">¶</a></h3>
<p>When routing from:</p>
<ul class="simple">
<li><p>From <strong>many</strong> different starting vertices</p></li>
<li><p>to <strong>many</strong> different ending vertices</p></li>
<li><p>Every tuple specifies a pair of a start vertex and an end vertex</p></li>
<li><p>Users can define the combinations as desired.</p></li>
<li><p>Needs a <a class="reference internal" href="#combinations-sql">Combinations SQL</a></p></li>
</ul>
</section>
</section>
<section id="inner-queries">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Inner Queries</a><a class="headerlink" href="#inner-queries" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id5">
<ul class="simple">
<li><p><a class="reference internal" href="#edges-sql" id="id46">Edges SQL</a></p>
<ul>
<li><p><a class="reference internal" href="#general" id="id47">General</a></p></li>
<li><p><a class="reference internal" href="#general-without-id" id="id48">General without <code class="docutils literal notranslate"><span class="pre">id</span></code></a></p></li>
<li><p><a class="reference internal" href="#general-with-x-y" id="id49">General with (X,Y)</a></p></li>
<li><p><a class="reference internal" href="#flow" id="id50">Flow</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#combinations-sql" id="id51">Combinations SQL</a></p></li>
<li><p><a class="reference internal" href="#restrictions-sql" id="id52">Restrictions SQL</a></p></li>
<li><p><a class="reference internal" href="#points-sql" id="id53">Points SQL</a></p></li>
</ul>
</nav>
<p>There are several kinds of valid inner queries and also the columns returned are
depending of the function.
Which kind of inner query will depend on the function’s requirements.
To simplify the variety of types, <strong>ANY-INTEGER</strong> and <strong>ANY-NUMERICAL</strong> is used.</p>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p>SMALLINT, INTEGER, BIGINT, REAL, FLOAT</p>
</dd>
</dl>
<section id="edges-sql">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Edges SQL</a><a class="headerlink" href="#edges-sql" title="Link to this heading">¶</a></h3>
<section id="general">
<h4><a class="toc-backref" href="#id47" role="doc-backlink">General</a><a class="headerlink" href="#general" title="Link to this heading">¶</a></h4>
<p class="rubric">Edges SQL for</p>
<ul class="simple">
<li><p><a class="reference internal" href="dijkstra-family.html"><span class="doc">Dijkstra - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="withPoints-family.html"><span class="doc">withPoints - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="bdDijkstra-family.html"><span class="doc">Bidirectional Dijkstra - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="components-family.html"><span class="doc">Components - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="kruskal-family.html"><span class="doc">Kruskal - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="prim-family.html"><span class="doc">Prim - Family of functions</span></a></p></li>
<li><p>Some uncategorised functions</p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.7%" />
<col style="width: 17.7%" />
<col style="width: 8.9%" />
<col style="width: 55.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p>-1</p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="general-without-id">
<h4><a class="toc-backref" href="#id48" role="doc-backlink">General without <code class="docutils literal notranslate"><span class="pre">id</span></code></a><a class="headerlink" href="#general-without-id" title="Link to this heading">¶</a></h4>
<p class="rubric">Edges SQL for</p>
<ul class="simple">
<li><p><a class="reference internal" href="allpairs-family.html"><span class="doc">All Pairs - Family of Functions</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.7%" />
<col style="width: 17.7%" />
<col style="width: 8.9%" />
<col style="width: 55.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p>-1</p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="general-with-x-y">
<h4><a class="toc-backref" href="#id49" role="doc-backlink">General with (X,Y)</a><a class="headerlink" href="#general-with-x-y" title="Link to this heading">¶</a></h4>
<p class="rubric">Edges SQL for</p>
<ul class="simple">
<li><p><a class="reference internal" href="aStar-family.html"><span class="doc">A* - Family of functions</span></a></p></li>
<li><p><a class="reference internal" href="bdAstar-family.html"><span class="doc">Bidirectional A* - Family of functions</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 15.6%" />
<col style="width: 18.2%" />
<col style="width: 9.1%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p>-1</p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>),</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x1</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>X coordinate of <code class="docutils literal notranslate"><span class="pre">source</span></code> vertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y1</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Y coordinate of <code class="docutils literal notranslate"><span class="pre">source</span></code> vertex.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">x2</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>X coordinate of <code class="docutils literal notranslate"><span class="pre">target</span></code> vertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y2</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Y coordinate of <code class="docutils literal notranslate"><span class="pre">target</span></code> vertex.</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="flow">
<h4><a class="toc-backref" href="#id50" role="doc-backlink">Flow</a><a class="headerlink" href="#flow" title="Link to this heading">¶</a></h4>
<p class="rubric">Edges SQL for <a class="reference internal" href="flow-family.html"><span class="doc">Flow - Family of functions</span></a></p>
<p class="rubric">Edges SQL for</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_pushRelabel.html"><span class="doc">pgr_pushRelabel</span></a></p></li>
<li><p><a class="reference internal" href="pgr_edmondsKarp.html"><span class="doc">pgr_edmondsKarp</span></a></p></li>
<li><p><a class="reference internal" href="pgr_boykovKolmogorov.html"><span class="doc">pgr_boykovKolmogorov</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.7%" />
<col style="width: 17.7%" />
<col style="width: 8.9%" />
<col style="width: 55.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">capacity</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_capacity</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>-1</p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
<p class="rubric">Edges SQL for the following functions of <a class="reference internal" href="flow-family.html"><span class="doc">Flow - Family of functions</span></a></p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_maxFlowMinCost.html"><span class="doc">pgr_maxFlowMinCost - Experimental</span></a></p></li>
<li><p><a class="reference internal" href="pgr_maxFlowMinCost_Cost.html"><span class="doc">pgr_maxFlowMinCost_Cost - Experimental</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.7%" />
<col style="width: 17.7%" />
<col style="width: 8.9%" />
<col style="width: 55.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the first end point vertex of the edge.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the second end point vertex of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">capacity</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Capacity of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_capacity</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>-1</p></td>
<td><p>Capacity of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>)</p>
<ul class="simple">
<li><p>When negative: edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) does not exist, therefore
it’s not part of the graph.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">target</span></code>) if it exist</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">reverse_cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(-1\)</span></p></td>
<td><p>Weight of the edge (<code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>) if it exist</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
</section>
<section id="combinations-sql">
<h3><a class="toc-backref" href="#id51" role="doc-backlink">Combinations SQL</a><a class="headerlink" href="#combinations-sql" title="Link to this heading">¶</a></h3>
<p class="rubric">Used in combination signatures</p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">source</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the departure vertex.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">target</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the arrival vertex.</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
</dl>
</section>
<section id="restrictions-sql">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">Restrictions SQL</a><a class="headerlink" href="#restrictions-sql" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 10.3%" />
<col style="width: 25.0%" />
<col style="width: 64.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">path</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></td>
<td><p>Sequence of edge identifiers that form a path that is not allowed to be
taken.
- Empty arrays or <code class="docutils literal notranslate"><span class="pre">NULL</span></code> arrays are ignored.
- Arrays that have a <code class="docutils literal notranslate"><span class="pre">NULL</span></code> element will raise an exception.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Cost</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td><p>Cost of taking the forbidden path.</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="points-sql">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">Points SQL</a><a class="headerlink" href="#points-sql" title="Link to this heading">¶</a></h3>
<p class="rubric">Points SQL for</p>
<ul class="simple">
<li><p><a class="reference internal" href="withPoints-family.html"><span class="doc">withPoints - Family of functions</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 15.6%" />
<col style="width: 18.2%" />
<col style="width: 9.1%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pid</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p><strong>value</strong></p></td>
<td><p>Identifier of the point.</p>
<ul class="simple">
<li><p>Use with positive value, as internally will be converted to negative
value</p></li>
<li><p>If column is present, it can not be NULL.</p></li>
<li><p>If column is not present, a sequential negative <strong>value</strong> will be given
automatically.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edge_id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifier of the “closest” edge to the point.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fraction</span></code></p></td>
<td><p><strong>ANY-NUMERICAL</strong></p></td>
<td></td>
<td><p>Value in &lt;0,1&gt; that indicates the relative postition from the first end
point of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">side</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHAR</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p>Value in [<code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">NULL</span></code>] indicating if the point is:</p>
<ul class="simple">
<li><p>In the right <code class="docutils literal notranslate"><span class="pre">r</span></code>,</p></li>
<li><p>In the left <code class="docutils literal notranslate"><span class="pre">l</span></code>,</p></li>
<li><p>In both sides <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
</section>
<section id="parameters">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Parameters</a><a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<p>The main parameter of the majority of the pgRouting functions is a query that
selects the edges of the graph.</p>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#edges-sql">Edges SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p><a class="reference internal" href="#edges-sql">Edges SQL</a> as described below.</p></td>
</tr>
</tbody>
</table>
<p>Depending on the family or category of a function it will have additional
parameters, some of them are compulsory and some are optional.</p>
<p>The compulsory parameters are nameless and must be given in the required order.
The optional parameters are named parameters and will have a default value.</p>
<section id="parameters-for-the-via-functions">
<h3>Parameters for the Via functions<a class="headerlink" href="#parameters-for-the-via-functions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_dijkstraVia.html"><span class="doc">pgr_dijkstraVia - Proposed</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.3%" />
<col style="width: 24.7%" />
<col style="width: 8.6%" />
<col style="width: 49.4%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#edges-sql">Edges SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td></td>
<td><p>SQL query as described.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>via vertices</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></td>
<td></td>
<td><p>Array of ordered vertices identifiers that are going to be visited.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">directed</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> Graph is considered <cite>Directed</cite></p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">false</span></code> the graph is considered as Undirected.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">strict</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> if a path is missing stops and returns <strong>EMPTY SET</strong></p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">false</span></code> ignores missing paths returning all paths found</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">U_turn_on_edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><ul class="simple">
<li><p>When <code class="docutils literal notranslate"><span class="pre">true</span></code> departing from a visited vertex will not try to avoid
using the edge used to reach it. In other words, U turn using the edge
with same identifier is allowed.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">false</span></code> when a departing from a visited vertex tries to avoid
using the edge used to reach it. In other words, U turn using the edge
with same identifier is used when no other path is found.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="for-the-trsp-functions">
<h3>For the TRSP functions<a class="headerlink" href="#for-the-trsp-functions" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_trsp.html"><span class="doc">pgr_trsp</span></a></p></li>
</ul>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 20.5%" />
<col style="width: 26.5%" />
<col style="width: 53.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#edges-sql">Edges SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>SQL query as described.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#restrictions-sql">Restrictions SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>SQL query as described.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#combinations-sql">Combinations SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p><a class="reference internal" href="#combinations-sql">Combinations SQL</a> as described below</p></td>
</tr>
<tr class="row-odd"><td><p><strong>start vid</strong></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the departure vertex.</p></td>
</tr>
<tr class="row-even"><td><p><strong>start vids</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></td>
<td><p>Array of identifiers of destination vertices.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>end vid</strong></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p>Identifier of the departure vertex.</p></td>
</tr>
<tr class="row-even"><td><p><strong>end vids</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></td>
<td><p>Array of identifiers of destination vertices.</p></td>
</tr>
</tbody>
</table>
<p>Where:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-INTEGER<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
</dl>
</section>
</section>
<section id="result-columns">
<h2><a class="toc-backref" href="#id16" role="doc-backlink">Result columns</a><a class="headerlink" href="#result-columns" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id6">
<ul class="simple">
<li><p><a class="reference internal" href="#result-columns-for-a-path" id="id54">Result columns for a path</a></p></li>
<li><p><a class="reference internal" href="#multiple-paths" id="id55">Multiple paths</a></p>
<ul>
<li><p><a class="reference internal" href="#selective-for-multiple-paths" id="id56">Selective for multiple paths.</a></p></li>
<li><p><a class="reference internal" href="#non-selective-for-multiple-paths" id="id57">Non selective for multiple paths</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#result-columns-for-cost-functions" id="id58">Result columns for cost functions</a></p></li>
<li><p><a class="reference internal" href="#result-columns-for-flow-functions" id="id59">Result columns for flow functions</a></p></li>
<li><p><a class="reference internal" href="#result-columns-for-spanning-tree-functions" id="id60">Result columns for spanning tree functions</a></p></li>
</ul>
</nav>
<p>There are several kinds of columns returned are depending of the function.</p>
<section id="result-columns-for-a-path">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">Result columns for a path</a><a class="headerlink" href="#result-columns-for-a-path" title="Link to this heading">¶</a></h3>
<p class="rubric">Used in functions that return one path solution</p>
<p>Returns set of <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_seq</span> <span class="pre">[,</span> <span class="pre">start_vid]</span> <span class="pre">[,</span> <span class="pre">end_vid],</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span>
<span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">path_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relative position in the path. Has value <strong>1</strong> for the beginning of a
path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex.
Returned when multiple starting vetrices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#many-to-one">Many to One</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">end_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex.
Returned when multiple ending vertices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#one-to-many">One to Many</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the
path sequence. <strong>-1</strong> for the last node of the path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the
path sequence.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Used in functions the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_withPoints.html"><span class="doc">pgr_withPoints</span></a></p></li>
</ul>
<p>Returns set of <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_seq</span> <span class="pre">[,</span> <span class="pre">start_pid]</span> <span class="pre">[,</span> <span class="pre">end_pid],</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span>
<span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">path_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relative position in the path.</p>
<ul class="simple">
<li><p><strong>1</strong> For the first row of the path.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start_pid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of a starting vertex/point of the path.</p>
<ul class="simple">
<li><p>When positive is the identifier of the starting vertex.</p></li>
<li><p>When negative is the identifier of the starting point.</p></li>
<li><p>Returned on <a class="reference internal" href="#many-to-one">Many to One</a> and <a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">end_pid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of an ending vertex/point of the path.</p>
<ul class="simple">
<li><p>When positive is the identifier of the ending vertex.</p></li>
<li><p>When negative is the identifier of the ending point.</p></li>
<li><p>Returned on <a class="reference internal" href="#one-to-many">One to Many</a> and <a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_pid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_pid</span></code>.</p>
<ul class="simple">
<li><p>When positive is the identifier of the a vertex.</p></li>
<li><p>When negative is the identifier of the a point.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the
path sequence.</p>
<ul class="simple">
<li><p><strong>-1</strong> for the last row of the path.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the
path sequence.</p>
<ul class="simple">
<li><p><strong>0</strong> For the first row of the path.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p>
<ul class="simple">
<li><p><strong>0</strong> For the first row of the path.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Used in functions the following:</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_dijkstraNear.html"><span class="doc">pgr_dijkstraNear - Proposed</span></a></p></li>
</ul>
<p>Returns <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_seq,</span> <span class="pre">start_vid,</span> <span class="pre">end_vid,</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span> <span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">path_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relative position in the path. Has value <strong>1</strong> for the beginning of a
path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex of the current path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">end_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex of the current path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">node</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the
path sequence. <strong>-1</strong> for the last node of the path.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the
path sequence.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="multiple-paths">
<h3><a class="toc-backref" href="#id55" role="doc-backlink">Multiple paths</a><a class="headerlink" href="#multiple-paths" title="Link to this heading">¶</a></h3>
<section id="selective-for-multiple-paths">
<h4><a class="toc-backref" href="#id56" role="doc-backlink">Selective for multiple paths.</a><a class="headerlink" href="#selective-for-multiple-paths" title="Link to this heading">¶</a></h4>
<p>The columns depend on the function call.</p>
<p>Set of <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_id,</span> <span class="pre">path_seq</span> <span class="pre">[,</span> <span class="pre">start_vid]</span> <span class="pre">[,</span> <span class="pre">end_vid],</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span>
<span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">path_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Path identifier.</p>
<ul class="simple">
<li><p>Has value <strong>1</strong> for the first of a path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to
<code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">path_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relative position in the path. Has value <strong>1</strong> for the beginning of a
path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex.
Returned when multiple starting vetrices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#many-to-one">Many to One</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
<li><p><a class="reference internal" href="#combinations">Combinations</a></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">end_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex.
Returned when multiple ending vertices are in the query.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#one-to-many">One to Many</a></p></li>
<li><p><a class="reference internal" href="#many-to-many">Many to Many</a></p></li>
<li><p><a class="reference internal" href="#combinations">Combinations</a></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the
path sequence. <strong>-1</strong> for the last node of the path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the
path sequence.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="non-selective-for-multiple-paths">
<h4><a class="toc-backref" href="#id57" role="doc-backlink">Non selective for multiple paths</a><a class="headerlink" href="#non-selective-for-multiple-paths" title="Link to this heading">¶</a></h4>
<p>Regardless of the call, al the columns are returned.</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_trsp.html"><span class="doc">pgr_trsp</span></a></p></li>
</ul>
<p>Returns set of <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_id,</span> <span class="pre">path_seq,</span> <span class="pre">start_vid,</span> <span class="pre">end_vid,</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span>
<span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">path_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Path identifier.</p>
<ul class="simple">
<li><p>Has value <strong>1</strong> for the first of a path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to
<code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">path_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relative position in the path. Has value <strong>1</strong> for the beginning of a
path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">end_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">node</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the node in the path from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge used to go from <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next node in the
path sequence. <strong>-1</strong> for the last node of the path.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse from <code class="docutils literal notranslate"><span class="pre">node</span></code> using <code class="docutils literal notranslate"><span class="pre">edge</span></code> to the next node in the
path sequence.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="result-columns-for-cost-functions">
<h3><a class="toc-backref" href="#id58" role="doc-backlink">Result columns for cost functions</a><a class="headerlink" href="#result-columns-for-cost-functions" title="Link to this heading">¶</a></h3>
<p class="rubric">Used in the following</p>
<ul class="simple">
<li><p><a class="reference internal" href="cost-category.html"><span class="doc">Cost - Category</span></a></p></li>
<li><p><a class="reference internal" href="costMatrix-category.html"><span class="doc">Cost Matrix - Category</span></a></p></li>
<li><p><a class="reference internal" href="allpairs-family.html"><span class="doc">All Pairs - Family of Functions</span></a></p></li>
</ul>
<p>Set of <code class="docutils literal notranslate"><span class="pre">(start_vid,</span> <span class="pre">end_vid,</span> <span class="pre">agg_cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the starting vertex.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">end_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the ending vertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Aggregate cost from <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> to <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When start_vid or end_vid columns have negative values, the identifier is for
a Point.</p>
</div>
</section>
<section id="result-columns-for-flow-functions">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">Result columns for flow functions</a><a class="headerlink" href="#result-columns-for-flow-functions" title="Link to this heading">¶</a></h3>
<p class="rubric">Edges SQL for the following</p>
<ul class="simple">
<li><p><a class="reference internal" href="flow-family.html"><span class="doc">Flow - Family of functions</span></a></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>seq</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INT</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>edge</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge in the original query
(edges_sql).</p></td>
</tr>
<tr class="row-even"><td><p><strong>start_vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the first end point vertex of
the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>end_vid</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the second end point vertex of
the edge.</p></td>
</tr>
<tr class="row-even"><td><p><strong>flow</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Flow through the edge in the direction
(<code class="docutils literal notranslate"><span class="pre">start_vid</span></code>, <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>residual_capacity</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Residual capacity of the edge in the direction
(<code class="docutils literal notranslate"><span class="pre">start_vid</span></code>, <code class="docutils literal notranslate"><span class="pre">end_vid</span></code>).</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Edges SQL for the following functions of <a class="reference internal" href="flow-family.html"><span class="doc">Flow - Family of functions</span></a></p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_maxFlowMinCost.html"><span class="doc">pgr_maxFlowMinCost - Experimental</span></a></p></li>
</ul>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>seq</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INT</span></code></p></td>
<td><p>Sequential value starting from <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>edge</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge in the original query
(edges_sql).</p></td>
</tr>
<tr class="row-even"><td><p><strong>source</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the first end point vertex of
the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>target</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the second end point vertex of
the edge.</p></td>
</tr>
<tr class="row-even"><td><p><strong>flow</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Flow through the edge in the direction
(source, target).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>residual_capacity</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Residual capacity of the edge in the direction
(source, target).</p></td>
</tr>
<tr class="row-even"><td><p><strong>cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>The cost of sending this flow through the edge
in the direction (source, target).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>agg_cost</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>The aggregate cost.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="result-columns-for-spanning-tree-functions">
<h3><a class="toc-backref" href="#id60" role="doc-backlink">Result columns for spanning tree functions</a><a class="headerlink" href="#result-columns-for-spanning-tree-functions" title="Link to this heading">¶</a></h3>
<p class="rubric">Edges SQL for the following</p>
<ul class="simple">
<li><p><a class="reference internal" href="pgr_prim.html"><span class="doc">pgr_prim</span></a></p></li>
<li><p><a class="reference internal" href="pgr_kruskal.html"><span class="doc">pgr_kruskal</span></a></p></li>
</ul>
<p>Returns set of <code class="docutils literal notranslate"><span class="pre">(edge,</span> <span class="pre">cost)</span></code></p>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">edge</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifier of the edge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Cost to traverse the edge.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="performance-tips">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Performance Tips</a><a class="headerlink" href="#performance-tips" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="id7">
<ul class="simple">
<li><p><a class="reference internal" href="#for-the-routing-functions" id="id61">For the Routing functions</a></p></li>
</ul>
</nav>
<section id="for-the-routing-functions">
<h3><a class="toc-backref" href="#id61" role="doc-backlink">For the Routing functions</a><a class="headerlink" href="#for-the-routing-functions" title="Link to this heading">¶</a></h3>
<p>To get faster results bound the queries to an area of interest of routing.</p>
<p>In this example Use an inner query SQL that does not include some edges in the
routing function and is within the area of the results.</p>
<p>Given this area:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="nb">id</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">reverse_cost</span>
<span class="n">FROM</span> <span class="n">edges</span>
<span class="n">WHERE</span> <span class="n">geom</span> <span class="o">&amp;&amp;</span> <span class="p">(</span>
  <span class="n">SELECT</span> <span class="n">st_buffer</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">myarea</span>
  <span class="n">FROM</span> <span class="n">edges</span> <span class="n">where</span> <span class="nb">id</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="n">ORDER</span> <span class="n">BY</span> <span class="nb">id</span><span class="p">;</span>
 <span class="nb">id</span> <span class="o">|</span> <span class="n">source</span> <span class="o">|</span> <span class="n">target</span> <span class="o">|</span> <span class="n">cost</span> <span class="o">|</span> <span class="n">reverse_cost</span>
<span class="o">----+--------+--------+------+--------------</span>
  <span class="mi">1</span> <span class="o">|</span>      <span class="mi">5</span> <span class="o">|</span>      <span class="mi">6</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
  <span class="mi">2</span> <span class="o">|</span>      <span class="mi">6</span> <span class="o">|</span>     <span class="mi">10</span> <span class="o">|</span>   <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
  <span class="mi">4</span> <span class="o">|</span>      <span class="mi">6</span> <span class="o">|</span>      <span class="mi">7</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
  <span class="mi">6</span> <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
  <span class="mi">7</span> <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span>      <span class="mi">7</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
  <span class="mi">8</span> <span class="o">|</span>      <span class="mi">7</span> <span class="o">|</span>     <span class="mi">11</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
 <span class="mi">10</span> <span class="o">|</span>      <span class="mi">7</span> <span class="o">|</span>      <span class="mi">8</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
 <span class="mi">12</span> <span class="o">|</span>      <span class="mi">8</span> <span class="o">|</span>     <span class="mi">12</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>           <span class="o">-</span><span class="mi">1</span>
 <span class="mi">14</span> <span class="o">|</span>      <span class="mi">8</span> <span class="o">|</span>      <span class="mi">9</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span>            <span class="mi">1</span>
 <span class="mi">19</span> <span class="o">|</span>      <span class="mi">4</span> <span class="o">|</span>      <span class="mi">8</span> <span class="o">|</span>    <span class="mi">0</span> <span class="o">|</span>            <span class="mi">0</span>
<span class="p">(</span><span class="mi">10</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<p>Calculate a route:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_dijkstra($$
  SELECT id, source, target, cost, reverse_cost
  FROM edges
  WHERE geom &amp;&amp; (
    SELECT st_buffer(geom, 1) AS myarea
    FROM edges WHERE id = 6)$$,
  7, 8);
 seq | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
-----+----------+-----------+---------+------+------+------+----------
   1 |        1 |         7 |       8 |    7 |   10 |    1 |        0
   2 |        2 |         7 |       8 |    8 |   -1 |    0 |        1
(2 rows)

</pre></div>
</div>
</section>
</section>
<section id="how-to-contribute">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">How to contribute</a><a class="headerlink" href="#how-to-contribute" title="Link to this heading">¶</a></h2>
<p class="rubric">Wiki</p>
<ul class="simple">
<li><p>Edit an existing <a class="reference external" href="https://github.com/pgRouting/pgrouting/wiki">pgRouting Wiki</a> page.</p></li>
<li><p>Or create a new Wiki page</p>
<ul>
<li><p>Create a page on the <a class="reference external" href="https://github.com/pgRouting/pgrouting/wiki">pgRouting Wiki</a></p></li>
<li><p>Give the title an appropriate name</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://github.com/pgRouting/pgrouting/wiki/How-to:-Handle-parallel-edges-(KSP)">Example</a></p></li>
</ul>
<p class="rubric">Adding Functionality to pgRouting</p>
<p>Consult the <a class="reference external" href="https://docs.pgrouting.org/doxy/2.4/index.html">developer’s documentation</a></p>
<p class="rubric">Indices and tables</p>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>


        </div>
          
    </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright pgRouting Contributors - Version v4.0.<br/>
      Last updated on Apr 19, 2025.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 8.2.3.<br/>
    </p>
  </div>
</footer>
  </body>
</html>