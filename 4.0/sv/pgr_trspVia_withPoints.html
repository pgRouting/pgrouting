

<!DOCTYPE html>

<html lang="sv" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>pgr_trspVia_medPunkter &#8212; pgRouting Manual (4.0-alpha1)</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-sphinx.css?v=5a695559" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css?v=4a28828c" />
    <script src="_static/documentation_options.js?v=6ca8ab9b"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/page_history.js?v=ee02e9fc"></script>
    <script src="_static/translations.js?v=92a62177"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Sök" href="search.html" />
    <link rel="next" title="pgr_turnRestrictedPath - Experimentell" href="pgr_turnRestrictedPath.html" />
    <link rel="prev" title="pgr_trsp_medPunkter" href="pgr_trsp_withPoints.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="index.html">
          pgRouting</a>
        <span class="navbar-text pull-left"><b>v4.0</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-introduction.html">Introduktion</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampledata.html">Exempeldata</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-concepts.html">pgRouting-koncept</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="routingFunctions.html">Funktionsfamiljer</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proposed.html">Föreslagna funktioner</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Experimentella funktioner</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Anteckningar för release</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migrationsguide</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">pgr_trspVia_medPunkter</span></code></a><ul>
<li><a class="reference internal" href="#description">Beskrivning</a></li>
<li><a class="reference internal" href="#signatures">Underskrifter</a><ul>
<li><a class="reference internal" href="#one-via">En Via</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters">Parametrar</a><ul>
<li><a class="reference internal" href="#optional-parameters">Valfria parametrar</a></li>
<li><a class="reference internal" href="#via-optional-parameters">Via valfria parametrar</a></li>
<li><a class="reference internal" href="#with-points-optional-parameters">Med punkter valfria parametrar</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inner-queries">Inre frågor</a><ul>
<li><a class="reference internal" href="#edges-sql">Kanter SQL</a></li>
<li><a class="reference internal" href="#restrictions-sql">Begränsningar SQL</a></li>
<li><a class="reference internal" href="#points-sql">Punkt SQL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#result-columns">Resultat kolumner</a></li>
<li><a class="reference internal" href="#additional-examples">Ytterligare exempel</a><ul>
<li><a class="reference internal" href="#use-pgr-findcloseedges-for-points-on-the-fly">Använd <code class="docutils literal notranslate"><span class="pre">pgr_findCloseEdges</span></code> för punkter i farten</a></li>
<li><a class="reference internal" href="#usage-variations">Variationer i användning</a><ul>
<li><a class="reference internal" href="#aggregate-cost-of-the-third-path">Sammanlagd kostnad för det tredje tågläget.</a></li>
<li><a class="reference internal" href="#route-s-aggregate-cost-of-the-route-at-the-end-of-the-third-path">Ruttens sammanlagda kostnad för rutten vid slutet av den tredje vägen.</a></li>
<li><a class="reference internal" href="#nodes-visited-in-the-route">Noder som besökts i rutten.</a></li>
<li><a class="reference internal" href="#the-aggregate-costs-of-the-route-when-the-visited-vertices-are-reached">De sammanlagda kostnaderna för rutten när de besökta topparna nås.</a></li>
<li><a class="reference internal" href="#status-of-passes-in-front-or-visits-of-the-nodes-and-points">Status för ”passeringar framför” eller ”besök” av noder och punkter.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulation-of-how-algorithm-works">Simulering av hur algoritmen fungerar.</a></li>
</ul>
</li>
<li><a class="reference internal" href="#see-also">Se även</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pgr_trsp_withPoints.html" title="Previous Chapter: pgr_trsp_medPunkter"><span class="icon-chevron-left visible-tablet"></span><span class="hidden-sm hidden-tablet">&laquo; pgr_trsp_medPunkter</span>
    </a>
  </li>
  <li>
    <a href="pgr_turnRestrictedPath.html" title="Next Chapter: pgr_turnRestrictedPath - Experimentell"><span class="icon-chevron-right visible-tablet"></span><span class="hidden-sm hidden-tablet">pgr_turnRestr... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
    <div class="row">
        <div class="body span12 content" role="main">
            <script> document.write(get_history('pgr_trspVia_withPoints','sv'));  </script>
            
  <div class="line-block" id="index-0">
<div class="line"><br /></div>
</div>
<section id="pgr-trspvia-withpoints">
<h1><code class="docutils literal notranslate"><span class="pre">pgr_trspVia_medPunkter</span></code><a class="headerlink" href="#pgr-trspvia-withpoints" title="Link to this heading">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">pgr_trspVia_withPoints</span></code> - Rutt som går igenom en lista med toppar och/eller punkter med restriktioner.</p>
<p class="rubric">Tillgänglighet</p>
<p class="rubric">Version 4.0.0</p>
<ul class="simple">
<li><p>Funktion befordrad till tjänsteman.</p></li>
<li><p><strong>Driving side</strong> parameter is positional unnamed.</p>
<ul>
<li><p>Giltiga värden beror på typ av graf</p></li>
</ul>
</li>
<li><p>Förändring på gång, signaturer inte längre tillgängliga:</p>
<ul>
<li><p>pgr_trspvia_withpoints(text,text,text,anyarray,boolean,boolean,boolean,character,boolean)</p></li>
<li><p>pgr_trspviaedges(text,integer[],double precision[],boolean,boolean,text)</p></li>
</ul>
</li>
</ul>
<p class="rubric">Version 3.4.0</p>
<ul class="simple">
<li><p>Ny föreslagen funktion.</p></li>
<li><p>Föråldrade signaturer</p>
<ul>
<li><p>pgr_trspviaedges(text,integer[],double precision[],boolean,boolean,text)</p></li>
</ul>
</li>
</ul>
<section id="description">
<h2>Beskrivning<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p>Med tanke på en graf, en uppsättning begränsningar på grafens kanter, en uppsättning punkter på grafens kanter och en lista med vertexer, är denna funktion likvärdig med att hitta den kortaste vägen mellan <span class="math notranslate nohighlight">\(vertex_i\)</span> och <span class="math notranslate nohighlight">\(vertex_{i+1}\)</span> (där <span class="math notranslate nohighlight">\(vertex\)</span> kan vara en vertex eller en punkt i grafen) för alla <span class="math notranslate nohighlight">\(i &lt; size\_of(via\;vertices)\)</span> och försöker att inte använda begränsade vägar.</p>
<dl class="field-list simple">
<dt class="field-odd">Rutt<span class="colon">:</span></dt>
<dd class="field-odd"><p>är en sekvens av banor</p>
</dd>
<dt class="field-even">Sökväg<span class="colon">:</span></dt>
<dd class="field-even"><p>är en del av rutten.</p>
</dd>
</dl>
<p>Den allmänna algoritmen är som följer:</p>
<ul class="simple">
<li><p>Bygg grafen med de nya punkterna.</p>
<ul>
<li><p>Punkternas identifierare kommer att omvandlas till negativa värden.</p></li>
<li><p>Topparnas identifierare kommer att förbli positiva.</p></li>
</ul>
</li>
<li><p>Exekvera en <a class="reference internal" href="pgr_withPointsVia.html"><span class="doc">pgr_medPointsVia</span></a>.</p></li>
<li><p>För uppsättningen av vägar för lösningen som passerar genom en restriktion gäller följande</p>
<ul>
<li><p>Utför <strong>TRSP</strong>-algoritmen med begränsningar för banan.</p></li>
<li><p><strong>NOTE</strong> när detta görs ignoreras flaggan <code class="docutils literal notranslate"><span class="pre">U_turn_on_edge</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Observera</p>
<p>Använd inte negativa värden på identifierare för de inre frågorna.</p>
</div>
<p><a class="reference external" href="https://www.boost.org/libs/graph"><img alt="Öka grafen inuti" src="_images/boost-inside.jpeg" style="height: 18px;" /></a> Boost-graf inuti</p>
</section>
<section id="signatures">
<h2>Underskrifter<a class="headerlink" href="#signatures" title="Link to this heading">¶</a></h2>
<section id="one-via">
<span id="index-1"></span><h3>En Via<a class="headerlink" href="#one-via" title="Link to this heading">¶</a></h3>
<div class="signatures admonition">
<p class="admonition-title"></p>
<div class="line-block">
<div class="line">pgr_trspVia_withPoints(<a class="reference internal" href="#edges-sql">Edges SQL</a>, <a class="reference internal" href="#restrictions-sql">Restrictions SQL</a>, <a class="reference internal" href="#points-sql">Points SQL</a>, <strong>via vertices</strong>, [<strong>driving side</strong>,] [<strong>options</strong>])</div>
<div class="line"><strong>options:</strong> <code class="docutils literal notranslate"><span class="pre">[directed,</span> <span class="pre">strict,</span> <span class="pre">U_turn_on_edge,</span> <span class="pre">details]</span></code></div>
</div>
<div class="line-block">
<div class="line">Returnerar uppsättning av <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">path_id,</span> <span class="pre">path_seq,</span> <span class="pre">start_vid,</span> <span class="pre">end_vid,</span> <span class="pre">node,</span> <span class="pre">edge,</span> <span class="pre">cost,</span> <span class="pre">agg_cost,</span> <span class="pre">route_agg_cost)</span></code></div>
<div class="line">ELLER TOM UPPSÄTTNING</div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Exempel<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hitta den rutt som besöker topparna <span class="math notranslate nohighlight">\(\{-6, 15, -5\\}\)</span> i den ordningen i en riktad graf.</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 15, -5]);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |        -6 |      15 |   -6 |    4 |  0.3 |        0 |              0
   2 |       1 |        2 |        -6 |      15 |    7 |   10 |    1 |      0.3 |            0.3
   3 |       1 |        3 |        -6 |      15 |    8 |   12 |    1 |      1.3 |            1.3
   4 |       1 |        4 |        -6 |      15 |   12 |   13 |    1 |      2.3 |            2.3
   5 |       1 |        5 |        -6 |      15 |   17 |   15 |    1 |      3.3 |            3.3
   6 |       1 |        6 |        -6 |      15 |   16 |   16 |    1 |      4.3 |            4.3
   7 |       1 |        7 |        -6 |      15 |   15 |   -1 |    0 |      5.3 |            5.3
   8 |       2 |        1 |        15 |      -5 |   15 |    3 |    1 |        0 |            5.3
   9 |       2 |        2 |        15 |      -5 |   10 |    5 |  0.8 |        1 |            6.3
  10 |       2 |        3 |        15 |      -5 |   -5 |   -2 |    0 |      1.8 |            7.1
(10 rows)

</pre></div>
</div>
</section>
</section>
<section id="parameters">
<h2>Parametrar<a class="headerlink" href="#parameters" title="Link to this heading">¶</a></h2>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference internal" href="#edges-sql">Kanter SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>SQL-fråga enligt beskrivning.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#restrictions-sql">Begränsningar SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>SQL-fråga enligt beskrivning.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#points-sql">Punkt SQL</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TEXT</span></code></p></td>
<td><p>SQL-fråga enligt beskrivning.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>via toppar</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [ <strong>ANY-TAL</strong> ]</p></td>
<td><p>Array av ordnade toppunktsidentifierare som kommer att besökas.</p>
<ul class="simple">
<li><p>När den är positiv betraktas den som en vertexidentifierare</p></li>
<li><p>När den är negativ betraktas den som en punktidentifierare</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 19.4%" />
<col style="width: 19.4%" />
<col style="width: 61.1%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>[<strong>driving side</strong>]</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHAR</span></code></p></td>
<td><p>Värde i [<code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>] som anger om förarsidan är:</p>
<ul class="simple">
<li><p>For directed graph:</p>
<ul>
<li><p>[<code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span></code>] for right driving side</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>] for left driving side</p></li>
</ul>
</li>
<li><p>For undirected graph:</p>
<ul>
<li><p>[<code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>] for both driving sides</p></li>
</ul>
</li>
<li><p>Default values when parameter is missing:</p>
<ul>
<li><p>[<code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span></code>] for directed graph</p></li>
<li><p>[<code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">L</span></code>] for undirected graph</p></li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Var:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-TAL<span class="colon">:</span></dt>
<dd class="field-odd"><p>SMALLINT, INTEGER, BIGINT</p>
</dd>
</dl>
<section id="optional-parameters">
<h3>Valfria parametrar<a class="headerlink" href="#optional-parameters" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<thead>
<tr class="row-odd"><th class="head"><p>Kolumn</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Standard</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">riktad</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><ul class="simple">
<li><p>När <code class="docutils literal notranslate"><span class="pre">true</span></code> anses grafen vara <cite>Directed`</cite></p></li>
<li><p>När den är <code class="docutils literal notranslate"><span class="pre">falsk</span></code> betraktas grafen som <cite>Ondirected`</cite>.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="via-optional-parameters">
<h3>Via valfria parametrar<a class="headerlink" href="#via-optional-parameters" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 15.9%" />
<col style="width: 8.0%" />
<col style="width: 8.0%" />
<col style="width: 68.2%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Standard</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">strikt</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><ul class="simple">
<li><p>När <code class="docutils literal notranslate"><span class="pre">true</span></code> om en sökväg saknas stoppar och returnerar <strong>EMPTY SET</strong></p></li>
<li><p>När <code class="docutils literal notranslate"><span class="pre">false</span></code> ignorerar saknade sökvägar returneras alla sökvägar som hittats</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">U_vändning_på_kanten</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p></td>
<td><ul class="simple">
<li><p>När <code class="docutils literal notranslate"><span class="pre">true</span></code> avgår från en besökt vertex kommer inte att försöka undvika</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
<section id="with-points-optional-parameters">
<h3>Med punkter valfria parametrar<a class="headerlink" href="#with-points-optional-parameters" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 15.9%" />
<col style="width: 8.0%" />
<col style="width: 8.0%" />
<col style="width: 68.2%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Standard</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">detaljer</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
<td><p>För att visa punkter stoppar.</p>
<ul class="simple">
<li><p>När <code class="docutils literal notranslate"><span class="pre">true</span></code> visas kommer resultaten att inkludera de punkter som ligger i banan.</p></li>
<li><p>När <code class="docutils literal notranslate"><span class="pre">false</span></code> visas kommer resultaten inte att omfatta de punkter som ligger i banan.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="inner-queries">
<h2>Inre frågor<a class="headerlink" href="#inner-queries" title="Link to this heading">¶</a></h2>
<section id="edges-sql">
<h3>Kanter SQL<a class="headerlink" href="#edges-sql" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 17.7%" />
<col style="width: 17.7%" />
<col style="width: 8.9%" />
<col style="width: 55.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Kolumn</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Standard</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifierare av kanten.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Källa</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifierare för den första slutpunktsvertexen på kanten.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mål</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifierare för den andra slutpunktsvertexen på kanten.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><strong>ANY-NUMERISK</strong></p></td>
<td></td>
<td><p>Kantvikt (<code class="docutils literal notranslate"><span class="pre">källa</span></code>, <code class="docutils literal notranslate"><span class="pre">mål</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">omvända_kostnader</span></code></p></td>
<td><p><strong>ANY-NUMERISK</strong></p></td>
<td><p>-1</p></td>
<td><p>Kantvikt (<code class="docutils literal notranslate"><span class="pre">mål</span></code>, <code class="docutils literal notranslate"><span class="pre">källa</span></code>)</p>
<ul class="simple">
<li><p>När negativ: kanten (<code class="docutils literal notranslate"><span class="pre">mål</span></code>, <code class="docutils literal notranslate"><span class="pre">källa</span></code>) existerar inte, därför är den inte en del av grafen.</p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Var:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-TAL<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="restrictions-sql">
<h3>Begränsningar SQL<a class="headerlink" href="#restrictions-sql" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 10.3%" />
<col style="width: 25.0%" />
<col style="width: 64.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Kolumn</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Sökväg</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">ARRAY</span></code> [<strong>ANY-INTEGER</strong>]</p></td>
<td><p>Sekvens av kantidentifierare som bildar en väg som inte är tillåten att ta. - Tomma arrayer eller <code class="docutils literal notranslate"><span class="pre">NULL</span></code> arrayer ignoreras. - Arrayer som har ett <code class="docutils literal notranslate"><span class="pre">NULL</span></code>-element kommer att ge upphov till ett undantag.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Kostnad</span></code></p></td>
<td><p><strong>ANY-NUMERISK</strong></p></td>
<td><p>Kostnaden för att gå den förbjudna vägen.</p></td>
</tr>
</tbody>
</table>
<p>Var:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-TAL<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
<section id="points-sql">
<h3>Punkt SQL<a class="headerlink" href="#points-sql" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 15.6%" />
<col style="width: 18.2%" />
<col style="width: 9.1%" />
<col style="width: 57.1%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Standard</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">pid</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td><p><strong>värde</strong></p></td>
<td><p>Identifierare av punkten.</p>
<ul class="simple">
<li><p>Använd med positivt värde, eftersom det internt kommer att omvandlas till negativt värde</p></li>
<li><p>Om kolumnen finns med kan den inte vara NULL.</p></li>
<li><p>Om kolumnen inte finns med kommer ett negativt <strong>värde</strong> att anges automatiskt i ordningsföljd.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Kedge_id</span></code></p></td>
<td><p><strong>ANY-INTEGER</strong></p></td>
<td></td>
<td><p>Identifierar den kant som ligger ”närmast” punkten.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">fraktion</span></code></p></td>
<td><p><strong>ANY-NUMERISK</strong></p></td>
<td></td>
<td><p>Värde i &lt;0,1&gt; som anger den relativa positionen från kantens första ändpunkt.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sida</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CHAR</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b</span></code></p></td>
<td><p>Värde i [<code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">l</span></code>, <code class="docutils literal notranslate"><span class="pre">NULL</span></code>] som anger om punkten är:</p>
<ul class="simple">
<li><p>I rätt ”r”,</p></li>
<li><p>I vänster ”l”,</p></li>
<li><p>I båda sidor <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">NULL</span></code></p></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Var:</p>
<dl class="field-list simple">
<dt class="field-odd">ANY-TAL<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p>
</dd>
<dt class="field-even">ANY-NUMERICAL<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">SMALLINT</span></code>, <code class="docutils literal notranslate"><span class="pre">INTEGER</span></code>, <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>, <code class="docutils literal notranslate"><span class="pre">REAL</span></code>, <code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p>
</dd>
</dl>
</section>
</section>
<section id="result-columns">
<h2>Resultat kolumner<a class="headerlink" href="#result-columns" title="Link to this heading">¶</a></h2>
<table class="docutils align-default" style="width: 81">
<colgroup>
<col style="width: 14.0%" />
<col style="width: 16.3%" />
<col style="width: 69.8%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Kolumn</p></th>
<th class="head"><p>Typ</p></th>
<th class="head"><p>Beskrivning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Sekventiellt värde med början från <strong>1</strong>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Sökväg_id</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Identifierare för ett led. Har värdet <strong>1</strong> för det första tågläget.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">väg_seq</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></p></td>
<td><p>Relativ position i tågläget. Har värdet <strong>1</strong> för början av ett tågläge.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">start_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifierare för stigens startvertex.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">slut_vid</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifierare för banans slutpunkt.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">nod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifierare av noden i sökvägen från <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> till <code class="docutils literal notranslate"><span class="pre">slut_vid</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">kant</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></p></td>
<td><p>Identifierar den kant som används för att gå från <code class="docutils literal notranslate"><span class="pre">node</span></code> till nästa nod i bansekvensen.</p>
<ul class="simple">
<li><p>-1 för den sista noden på vägen.</p></li>
<li><p>-2 för den sista noden i rutten.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Kostnad för att gå från <code class="docutils literal notranslate"><span class="pre">nod</span></code> med hjälp av <code class="docutils literal notranslate"><span class="pre">edge</span></code> till nästa nod i vägsekvensen.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Sammanlagd kostnad från <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> till <code class="docutils literal notranslate"><span class="pre">node</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">route_agg_cost</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></p></td>
<td><p>Total kostnad från <code class="docutils literal notranslate"><span class="pre">start_vid</span></code> av <code class="docutils literal notranslate"><span class="pre">seq</span> <span class="pre">=</span> <span class="pre">1</span></code> till <code class="docutils literal notranslate"><span class="pre">slut_vid</span></code> av den aktuella <code class="docutils literal notranslate"><span class="pre">seq</span></code>.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Observera</p>
<p>När kolumnerna <code class="docutils literal notranslate"><span class="pre">start_vid</span></code>, <code class="docutils literal notranslate"><span class="pre">end_vid</span></code> och <code class="docutils literal notranslate"><span class="pre">node</span></code> har negativa värden är identifieraren för en Point.</p>
</div>
</section>
<section id="additional-examples">
<h2>Ytterligare exempel<a class="headerlink" href="#additional-examples" title="Link to this heading">¶</a></h2>
<nav class="contents local" id="innehall">
<ul class="simple">
<li><p><a class="reference internal" href="#use-pgr-findcloseedges-for-points-on-the-fly" id="id1">Använd <code class="docutils literal notranslate"><span class="pre">pgr_findCloseEdges</span></code> för punkter i farten</a></p></li>
<li><p><a class="reference internal" href="#usage-variations" id="id2">Variationer i användning</a></p>
<ul>
<li><p><a class="reference internal" href="#aggregate-cost-of-the-third-path" id="id3">Sammanlagd kostnad för det tredje tågläget.</a></p></li>
<li><p><a class="reference internal" href="#route-s-aggregate-cost-of-the-route-at-the-end-of-the-third-path" id="id4">Ruttens sammanlagda kostnad för rutten vid slutet av den tredje vägen.</a></p></li>
<li><p><a class="reference internal" href="#nodes-visited-in-the-route" id="id5">Noder som besökts i rutten.</a></p></li>
<li><p><a class="reference internal" href="#the-aggregate-costs-of-the-route-when-the-visited-vertices-are-reached" id="id6">De sammanlagda kostnaderna för rutten när de besökta topparna nås.</a></p></li>
<li><p><a class="reference internal" href="#status-of-passes-in-front-or-visits-of-the-nodes-and-points" id="id7">Status för ”passeringar framför” eller ”besök” av noder och punkter.</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#simulation-of-how-algorithm-works" id="id8">Simulering av hur algoritmen fungerar.</a></p></li>
</ul>
</nav>
<section id="use-pgr-findcloseedges-for-points-on-the-fly">
<h3><a class="toc-backref" href="#id1" role="doc-backlink">Använd <code class="docutils literal notranslate"><span class="pre">pgr_findCloseEdges</span></code> för punkter i farten</a><a class="headerlink" href="#use-pgr-findcloseedges-for-points-on-the-fly" title="Link to this heading">¶</a></h3>
<p>Använder <a class="reference internal" href="pgr_findCloseEdges.html"><span class="doc">pgr_findCloseEdges</span></a>:</p>
<p>Besök från toppunkten <span class="math notranslate nohighlight">\(1\)</span> till de två platserna på grafen för punkten <cite>(2,9, 1,8)</cite> i ordning efter närhet till grafen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM  pgr_trspVia_withPoints(
  $e$ SELECT * FROM edges $e$,
  $r$ SELECT path, cost FROM restrictions $r$,
  $p$ SELECT edge_id, round(fraction::numeric, 2) AS fraction, side
      FROM pgr_findCloseEdges(
        $$SELECT id, geom FROM edges$$,
        (SELECT ST_POINT(2.9, 1.8)),
        0.5, cap =&gt; 2)
  $p$,
  ARRAY[1, -1, -2], details =&gt; true);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |         1 |      -1 |    1 |    6 |    1 |        0 |              0
   2 |       1 |        2 |         1 |      -1 |    3 |    7 |    1 |        1 |              1
   3 |       1 |        3 |         1 |      -1 |    7 |    8 |  0.9 |        2 |              2
   4 |       1 |        4 |         1 |      -1 |   -2 |    8 |  0.1 |      2.9 |            2.9
   5 |       1 |        5 |         1 |      -1 |   11 |    8 |    1 |        3 |              3
   6 |       1 |        6 |         1 |      -1 |    7 |   10 |    1 |        4 |              4
   7 |       1 |        7 |         1 |      -1 |    8 |   12 |    1 |        5 |              5
   8 |       1 |        8 |         1 |      -1 |   12 |   13 |    1 |        6 |              6
   9 |       1 |        9 |         1 |      -1 |   17 |   15 |    1 |        7 |              7
  10 |       1 |       10 |         1 |      -1 |   16 |   16 |    1 |        8 |              8
  11 |       1 |       11 |         1 |      -1 |   15 |    3 |    1 |        9 |              9
  12 |       1 |       12 |         1 |      -1 |   10 |    5 |  0.8 |       10 |             10
  13 |       1 |       13 |         1 |      -1 |   -1 |   -1 |    0 |     10.8 |           10.8
  14 |       2 |        1 |        -1 |      -2 |   -1 |    5 |  0.2 |        0 |           10.8
  15 |       2 |        2 |        -1 |      -2 |   11 |    8 |    1 |      0.2 |             11
  16 |       2 |        3 |        -1 |      -2 |    7 |    8 |  0.9 |      1.2 |             12
  17 |       2 |        4 |        -1 |      -2 |   -2 |   -2 |    0 |      2.1 |           12.9
(17 rows)

</pre></div>
</div>
<ul class="simple">
<li><p>Punkten <span class="math notranslate nohighlight">\(-1\)</span> motsvarar den närmaste kanten från punkten <cite>(2,9, 1,8)</cite>.</p></li>
<li><p>Punkten <span class="math notranslate nohighlight">\(-2\)</span> motsvarar nästa nära kant från punkten <cite>(2,9, 1,8)</cite>.</p></li>
<li><p>Punkt <span class="math notranslate nohighlight">\(-2\)</span> besöks på rutten till från toppunkt <span class="math notranslate nohighlight">\(1\)</span> till punkt <span class="math notranslate nohighlight">\(-1\)</span> (Se rad där <span class="math notranslate nohighlight">\(seq = 4\)</span>).</p></li>
</ul>
</section>
<section id="usage-variations">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Variationer i användning</a><a class="headerlink" href="#usage-variations" title="Link to this heading">¶</a></h3>
<p>Alla dessa exempel handlar om den rutt som besöker topparna <span class="math notranslate nohighlight">\(\{-6, 7, -4, 8, -2\\}\)</span> i den ordningen i en riktad graf.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2], &#39;L&#39;, directed =&gt; true);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |        -6 |       7 |   -6 |    4 |  0.3 |        0 |              0
   2 |       1 |        2 |        -6 |       7 |    7 |   -1 |    0 |      0.3 |            0.3
   3 |       2 |        1 |         7 |      -4 |    7 |    7 |    1 |        0 |            0.3
   4 |       2 |        2 |         7 |      -4 |    3 |    6 |  0.7 |        1 |            1.3
   5 |       2 |        3 |         7 |      -4 |   -4 |   -1 |    0 |      1.7 |              2
   6 |       3 |        1 |        -4 |       8 |   -4 |    6 |  1.3 |        0 |              2
   7 |       3 |        2 |        -4 |       8 |    3 |    7 |    1 |      1.3 |            3.3
   8 |       3 |        3 |        -4 |       8 |    7 |    4 |  0.6 |      2.3 |            4.3
   9 |       3 |        4 |        -4 |       8 |    7 |   10 |    1 |      2.9 |            4.9
  10 |       3 |        5 |        -4 |       8 |    8 |   -1 |    0 |      3.9 |            5.9
  11 |       4 |        1 |         8 |      -2 |    8 |   12 |    1 |        0 |            5.9
  12 |       4 |        2 |         8 |      -2 |   12 |   13 |    1 |        1 |            6.9
  13 |       4 |        3 |         8 |      -2 |   17 |   15 |  0.6 |        2 |            7.9
  14 |       4 |        4 |         8 |      -2 |   -2 |   -2 |    0 |      2.6 |            8.5
(14 rows)

</pre></div>
</div>
<section id="aggregate-cost-of-the-third-path">
<h4><a class="toc-backref" href="#id3" role="doc-backlink">Sammanlagd kostnad för det tredje tågläget.</a><a class="headerlink" href="#aggregate-cost-of-the-third-path" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT agg_cost FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2]
)
WHERE path_id = 3 AND edge &lt; 0;
 agg_cost
----------
      3.3
(1 row)

</pre></div>
</div>
</section>
<section id="route-s-aggregate-cost-of-the-route-at-the-end-of-the-third-path">
<h4><a class="toc-backref" href="#id4" role="doc-backlink">Ruttens sammanlagda kostnad för rutten vid slutet av den tredje vägen.</a><a class="headerlink" href="#route-s-aggregate-cost-of-the-route-at-the-end-of-the-third-path" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT route_agg_cost FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2])
WHERE path_id = 3 AND edge &lt; 0;
 route_agg_cost
----------------
            5.9
(1 row)

</pre></div>
</div>
</section>
<section id="nodes-visited-in-the-route">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">Noder som besökts i rutten.</a><a class="headerlink" href="#nodes-visited-in-the-route" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT row_number() over () as node_seq, node
FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2])
WHERE edge &lt;&gt; -1 ORDER BY seq;
 node_seq | node
----------+------
        1 |   -6
        2 |    7
        3 |    3
        4 |   -4
        5 |    3
        6 |    7
        7 |    7
        8 |    8
        9 |    7
       10 |   11
       11 |   16
       12 |   -2
(12 rows)

</pre></div>
</div>
</section>
<section id="the-aggregate-costs-of-the-route-when-the-visited-vertices-are-reached">
<h4><a class="toc-backref" href="#id6" role="doc-backlink">De sammanlagda kostnaderna för rutten när de besökta topparna nås.</a><a class="headerlink" href="#the-aggregate-costs-of-the-route-when-the-visited-vertices-are-reached" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT path_id, route_agg_cost FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2])
WHERE edge &lt; 0;
 path_id | route_agg_cost
---------+----------------
       1 |            0.3
       2 |            2.6
       3 |            5.9
       4 |            9.3
(4 rows)

</pre></div>
</div>
</section>
<section id="status-of-passes-in-front-or-visits-of-the-nodes-and-points">
<h4><a class="toc-backref" href="#id7" role="doc-backlink">Status för ”passeringar framför” eller ”besök” av noder och punkter.</a><a class="headerlink" href="#status-of-passes-in-front-or-visits-of-the-nodes-and-points" title="Link to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT seq, node, agg_cost, route_agg_cost,
CASE WHEN edge = -1 THEN $$visits$$
ELSE $$passes in front$$
END as status
FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 7, -4, 8, -2], details =&gt; true)
WHERE agg_cost &lt;&gt; 0 or seq = 1;
 seq | node | agg_cost | route_agg_cost |     status
-----+------+----------+----------------+-----------------
   1 |   -6 |        0 |              0 | passes in front
   2 |    7 |      0.3 |            0.3 | visits
   4 |    3 |        1 |            1.3 | passes in front
   5 |    1 |        2 |            2.3 | passes in front
   6 |   -4 |      2.3 |            2.6 | visits
   8 |    3 |      0.7 |            3.3 | passes in front
   9 |    7 |      1.7 |            4.3 | passes in front
  10 |   -6 |        2 |            4.6 | passes in front
  11 |    7 |      2.3 |            4.9 | passes in front
  12 |    8 |      3.3 |            5.9 | visits
  14 |    7 |        1 |            6.9 | passes in front
  15 |   11 |        2 |            7.9 | passes in front
  16 |   16 |        3 |            8.9 | passes in front
  17 |   -2 |      3.4 |            9.3 | passes in front
(14 rows)

</pre></div>
</div>
</section>
</section>
<section id="simulation-of-how-algorithm-works">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Simulering av hur algoritmen fungerar.</a><a class="headerlink" href="#simulation-of-how-algorithm-works" title="Link to this heading">¶</a></h3>
<p>Algoritmen utför en <a class="reference internal" href="pgr_withPointsVia.html"><span class="doc">pgr_medPointsVia</span></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM pgr_withPointsVia(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 15, -5]);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |        -6 |      15 |   -6 |    4 |  0.3 |        0 |              0
   2 |       1 |        2 |        -6 |      15 |    7 |    8 |    1 |      0.3 |            0.3
   3 |       1 |        3 |        -6 |      15 |   11 |    9 |    1 |      1.3 |            1.3
   4 |       1 |        4 |        -6 |      15 |   16 |   16 |    1 |      2.3 |            2.3
   5 |       1 |        5 |        -6 |      15 |   15 |   -1 |    0 |      3.3 |            3.3
   6 |       2 |        1 |        15 |      -5 |   15 |    3 |    1 |        0 |            3.3
   7 |       2 |        2 |        15 |      -5 |   10 |    5 |  0.8 |        1 |            4.3
   8 |       2 |        3 |        15 |      -5 |   -5 |   -2 |    0 |      1.8 |            5.1
(8 rows)

</pre></div>
</div>
<p>Detekterar vilka av sökvägarna som passerar genom en begränsning i detta fall är för <code class="docutils literal notranslate"><span class="pre">path_id</span> <span class="pre">=</span> <span class="pre">1</span></code> från <code class="docutils literal notranslate"><span class="pre">-6</span></code> till <code class="docutils literal notranslate"><span class="pre">15</span></code> eftersom sökvägen <span class="math notranslate nohighlight">\(9 \rightarrow 16\)</span> är begränsad.</p>
<p>Exekverar <a class="reference internal" href="TRSP-family.html#trsp-algorithm"><span class="std std-ref">TRSP-algoritm</span></a> för de motstridiga sökvägarna.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT 1 AS path_id, path_seq, start_vid, end_vid, node, edge, cost, agg_cost
FROM  pgr_trsp_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  -6, 15);
 path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
---------+----------+-----------+---------+------+------+------+----------
       1 |        1 |        -6 |      15 |   -6 |    4 |  0.3 |        0
       1 |        2 |        -6 |      15 |    7 |   10 |    1 |      0.3
       1 |        3 |        -6 |      15 |    8 |   12 |    1 |      1.3
       1 |        4 |        -6 |      15 |   12 |   13 |    1 |      2.3
       1 |        5 |        -6 |      15 |   17 |   15 |    1 |      3.3
       1 |        6 |        -6 |      15 |   16 |   16 |    1 |      4.3
       1 |        7 |        -6 |      15 |   15 |   -1 |    0 |      5.3
(7 rows)

</pre></div>
</div>
<p>Från resultatet av <a class="reference internal" href="pgr_withPointsVia.html"><span class="doc">pgr_medPointsVia</span></a> tar den bort de motstridiga vägarna och bygger lösningen med resultaten av algoritmen <a class="reference internal" href="pgr_trsp.html"><span class="doc">pgr_trsp</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>WITH
solutions AS (
  SELECT path_id, path_seq, start_vid, end_vid, node, edge, cost, agg_cost
  FROM  pgr_withPointsVia(
    $$SELECT id, source, target, cost, reverse_cost FROM edges$$,
    $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
    ARRAY[-6, 15, -5]) WHERE path_id != 1
  UNION
  SELECT 1 AS path_id, path_seq, start_vid, end_vid, node, edge, cost, agg_cost
  FROM  pgr_trsp_withPoints(
    $$SELECT id, source, target, cost, reverse_cost FROM edges$$,
    $$SELECT path, cost FROM restrictions$$,
    $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
    -6, 15)),
with_seq AS (
  SELECT row_number() over(ORDER BY path_id, path_seq) AS seq, *
  FROM solutions),
aggregation AS (SELECT seq, SUM(cost) OVER(ORDER BY seq) AS route_agg_cost FROM with_seq)
SELECT with_seq.*, COALESCE(route_agg_cost, 0) AS route_agg_cost
FROM with_seq LEFT JOIN aggregation ON (with_seq.seq = aggregation.seq + 1);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |        -6 |      15 |   -6 |    4 |  0.3 |        0 |              0
   2 |       1 |        2 |        -6 |      15 |    7 |   10 |    1 |      0.3 |            0.3
   3 |       1 |        3 |        -6 |      15 |    8 |   12 |    1 |      1.3 |            1.3
   4 |       1 |        4 |        -6 |      15 |   12 |   13 |    1 |      2.3 |            2.3
   5 |       1 |        5 |        -6 |      15 |   17 |   15 |    1 |      3.3 |            3.3
   6 |       1 |        6 |        -6 |      15 |   16 |   16 |    1 |      4.3 |            4.3
   7 |       1 |        7 |        -6 |      15 |   15 |   -1 |    0 |      5.3 |            5.3
   8 |       2 |        1 |        15 |      -5 |   15 |    3 |    1 |        0 |            5.3
   9 |       2 |        2 |        15 |      -5 |   10 |    5 |  0.8 |        1 |            6.3
  10 |       2 |        3 |        15 |      -5 |   -5 |   -2 |    0 |      1.8 |            7.1
(10 rows)

</pre></div>
</div>
<p>Får samma resultat som <code class="docutils literal notranslate"><span class="pre">pgr_trspVia_withPoints</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[-6, 15, -5]);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |        -6 |      15 |   -6 |    4 |  0.3 |        0 |              0
   2 |       1 |        2 |        -6 |      15 |    7 |   10 |    1 |      0.3 |            0.3
   3 |       1 |        3 |        -6 |      15 |    8 |   12 |    1 |      1.3 |            1.3
   4 |       1 |        4 |        -6 |      15 |   12 |   13 |    1 |      2.3 |            2.3
   5 |       1 |        5 |        -6 |      15 |   17 |   15 |    1 |      3.3 |            3.3
   6 |       1 |        6 |        -6 |      15 |   16 |   16 |    1 |      4.3 |            4.3
   7 |       1 |        7 |        -6 |      15 |   15 |   -1 |    0 |      5.3 |            5.3
   8 |       2 |        1 |        15 |      -5 |   15 |    3 |    1 |        0 |            5.3
   9 |       2 |        2 |        15 |      -5 |   10 |    5 |  0.8 |        1 |            6.3
  10 |       2 |        3 |        15 |      -5 |   -5 |   -2 |    0 |      1.8 |            7.1
(10 rows)

</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Exempel 8<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ibland ignoreras flaggan <code class="docutils literal notranslate"><span class="pre">U_turn_on_edge</span></code> när den är satt till <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
</dd>
</dl>
<p>Det första steget, att göra en <a class="reference internal" href="pgr_withPointsVia.html"><span class="doc">pgr_medPointsVia</span></a> tar hänsyn till att inte göra en U-sväng på samma kant. Men banan <span class="math notranslate nohighlight">\(9 \rightarrow 16\)</span> (rad 4 och 5) är begränsad och resultatet är att använda den.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM  pgr_withPointsVia(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[6, 7, 6], U_turn_on_edge =&gt; false);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |         6 |       7 |    6 |    4 |    1 |        0 |              0
   2 |       1 |        2 |         6 |       7 |    7 |   -1 |    0 |        1 |              1
   3 |       2 |        1 |         7 |       6 |    7 |    8 |    1 |        0 |              1
   4 |       2 |        2 |         7 |       6 |   11 |    9 |    1 |        1 |              2
   5 |       2 |        3 |         7 |       6 |   16 |   16 |    1 |        2 |              3
   6 |       2 |        4 |         7 |       6 |   15 |    3 |    1 |        3 |              4
   7 |       2 |        5 |         7 |       6 |   10 |    2 |    1 |        4 |              5
   8 |       2 |        6 |         7 |       6 |    6 |   -2 |    0 |        5 |              6
(8 rows)

</pre></div>
</div>
<p>När algoritmen <a class="reference internal" href="pgr_trsp_withPoints.html"><span class="doc">pgr_trsp_medPunkter</span></a> exekveras för den konfliktfyllda banan finns det ingen flagga <code class="docutils literal notranslate"><span class="pre">U_turn_on_edge</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT 5 AS path_id, path_seq, start_vid, end_vid, node, edge, cost, agg_cost
FROM  pgr_trsp_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  7, 6);
 path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost
---------+----------+-----------+---------+------+------+------+----------
       5 |        1 |         7 |       6 |    7 |    4 |    1 |        0
       5 |        2 |         7 |       6 |    6 |   -1 |    0 |        1
(2 rows)

</pre></div>
</div>
<p>Därför ignorerar resultatet flaggan <code class="docutils literal notranslate"><span class="pre">U_turn_on_edge</span></code> när den är inställd på <code class="docutils literal notranslate"><span class="pre">false</span></code>. Från <a class="reference internal" href="pgr_withPointsVia.html"><span class="doc">pgr_medPointsVia</span></a>-resultatet tar den bort de motstridiga vägarna och bygger lösningen med resultaten från <a class="reference internal" href="pgr_trsp.html"><span class="doc">pgr_trsp</span></a>-algoritmen. I det här fallet har en U-sväng gjorts med samma kant.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>SELECT * FROM  pgr_trspVia_withPoints(
  $$SELECT id, source, target, cost, reverse_cost FROM edges ORDER BY id$$,
  $$SELECT path, cost FROM restrictions$$,
  $$SELECT pid, edge_id, side, fraction FROM pointsOfInterest$$,
  ARRAY[6, 7, 6], U_turn_on_edge =&gt; false);
 seq | path_id | path_seq | start_vid | end_vid | node | edge | cost | agg_cost | route_agg_cost
-----+---------+----------+-----------+---------+------+------+------+----------+----------------
   1 |       1 |        1 |         6 |       7 |    6 |    4 |    1 |        0 |              0
   2 |       1 |        2 |         6 |       7 |    7 |   -1 |    0 |        1 |              1
   3 |       2 |        1 |         7 |       6 |    7 |    4 |    1 |        0 |              1
   4 |       2 |        2 |         7 |       6 |    6 |   -2 |    0 |        1 |              2
(4 rows)

</pre></div>
</div>
</section>
</section>
<section id="see-also">
<h2>Se även<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="TRSP-family.html"><span class="doc">TRSP - Familj av funktioner</span></a></p></li>
<li><p><a class="reference internal" href="via-category.html"><span class="doc">Via - Kategori</span></a></p></li>
<li><p><a class="reference internal" href="withPoints-category.html"><span class="doc">withPoints - Kategori</span></a></p></li>
<li><p><a class="reference internal" href="sampledata.html"><span class="doc">Exempeldata</span></a></p></li>
</ul>
<p class="rubric">Index och tabeller</p>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Söksida</span></a></p></li>
</ul>
</section>
</section>


        </div>
          
    </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright pgRouting Contributors - Version v4.0.<br/>
      Senast uppdaterad sep. 22, 2025.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.2.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>