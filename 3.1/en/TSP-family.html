<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Traveling Sales Person - Family of functions &#8212; pgRouting Manual (3.1)</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
<script src="_static/page_history.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pgr_TSP" href="pgr_TSP.html" />
    <link rel="prev" title="pgr_nodeNetwork" href="pgr_nodeNetwork.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html"><span><img src="_static/pgrouting.png"></span>
          pgRouting</a>
        <span class="navbar-text navbar-version pull-left"><b>v3.1.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sampledata.html">Sample Data</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgRouting-concepts.html">pgRouting Concepts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pgr_version.html">pgr_version</a></li>
<li class="toctree-l1"><a class="reference internal" href="pgr_full_version.html">pgr_full_version</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="routingFunctions.html">Function Families</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="proposed.html">Proposed Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="experimental.html">Experimental Functions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Traveling Sales Person - Family of functions</a><ul>
<li><a class="reference internal" href="#general-information">General Information</a><ul>
<li><a class="reference internal" href="#problem-definition">Problem Definition</a></li>
<li><a class="reference internal" href="#origin">Origin</a></li>
<li><a class="reference internal" href="#characteristics">Characteristics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulated-annealing-algorithm">Simulated Annealing Algorithm</a><ul>
<li><a class="reference internal" href="#pgrouting-implementation">pgRouting Implementation</a></li>
<li><a class="reference internal" href="#choosing-parameters">Choosing parameters</a></li>
<li><a class="reference internal" href="#description-of-the-control-parameters">Description of the Control Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#description-of-the-return-columns">Description of the return columns</a><ul>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="pgr_nodeNetwork.html" title="Previous Chapter: pgr_nodeNetwork"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; pgr_nodeNetwork</span>
    </a>
  </li>
  <li>
    <a href="pgr_TSP.html" title="Next Chapter: pgr_TSP"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">pgr_TSP &raquo;</span>
    </a>
  </li>
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
 <div class="line"><br/></div> <script> document.write(get_history("TSP-family","en")); </script>
      
  <div class="section" id="traveling-sales-person-family-of-functions">
<h1>Traveling Sales Person - Family of functions<a class="headerlink" href="#traveling-sales-person-family-of-functions" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="pgr_TSP.html"><span class="doc">pgr_TSP</span></a> - When input is given as matrix cell information.</li>
<li><a class="reference internal" href="pgr_TSPeuclidean.html"><span class="doc">pgr_TSPeuclidean</span></a> - When input are coordinates.</li>
</ul>
<div class="toctree-wrapper compound">
</div>
<ul class="simple">
</ul>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#general-information" id="id1">General Information</a><ul>
<li><a class="reference internal" href="#problem-definition" id="id2">Problem Definition</a></li>
<li><a class="reference internal" href="#origin" id="id3">Origin</a></li>
<li><a class="reference internal" href="#characteristics" id="id4">Characteristics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simulated-annealing-algorithm" id="id5">Simulated Annealing Algorithm</a><ul>
<li><a class="reference internal" href="#pgrouting-implementation" id="id6">pgRouting Implementation</a></li>
<li><a class="reference internal" href="#choosing-parameters" id="id7">Choosing parameters</a></li>
<li><a class="reference internal" href="#description-of-the-control-parameters" id="id8">Description of the Control Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#description-of-the-return-columns" id="id9">Description of the return columns</a><ul>
<li><a class="reference internal" href="#see-also" id="id10">See Also</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="general-information">
<h2><a class="toc-backref" href="#id1">General Information</a><a class="headerlink" href="#general-information" title="Permalink to this headline">¶</a></h2>
<div class="section" id="problem-definition">
<h3><a class="toc-backref" href="#id2">Problem Definition</a><a class="headerlink" href="#problem-definition" title="Permalink to this headline">¶</a></h3>
<p>The travelling salesman problem (TSP) or travelling salesperson problem asks the
following question:</p>
<p><em>Given a list of cities and the distances between each pair of cities, which is
the shortest possible route that visits each city exactly once and returns to the origin city?</em></p>
</div>
<div class="section" id="origin">
<h3><a class="toc-backref" href="#id3">Origin</a><a class="headerlink" href="#origin" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>The traveling sales person problem was studied in the 18th century by mathematicians</dt>
<dd><strong>Sir William Rowam Hamilton</strong> and <strong>Thomas Penyngton  Kirkman</strong>.</dd>
</dl>
<p>A discussion about the work of Hamilton &amp; Kirkman
can be found in the book <strong>Graph Theory (Biggs et  al. 1976)</strong>.</p>
<ul class="simple">
<li>ISBN-13: 978-0198539162</li>
<li>ISBN-10: 0198539169</li>
</ul>
<p>It is believed that the general form of the TSP have been first studied by Kalr Menger in Vienna and Harvard.
The problem was later promoted by Hassler, Whitney &amp; Merrill at Princeton.
A detailed description about the connection between Menger &amp; Whitney, and the development of the
TSP can be found in <a class="reference external" href="https://homepages.cwi.nl/~lex/files/histco.ps">On the history of combinatorial optimization (till 1960)</a></p>
</div>
<div class="section" id="characteristics">
<h3><a class="toc-backref" href="#id4">Characteristics</a><a class="headerlink" href="#characteristics" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The travel costs are symmetric:<ul>
<li>traveling costs from city A to city B are just as much as traveling from B to A.</li>
</ul>
</li>
<li>This problem is an NP-hard optimization problem.</li>
<li>To calculate the number of different tours through <span class="math notranslate nohighlight">\(n\)</span> cities:<ul>
<li>Given a starting city,</li>
<li>There are <span class="math notranslate nohighlight">\(n-1\)</span> choices for the second city,</li>
<li>And  <span class="math notranslate nohighlight">\(n-2\)</span> choices for the third city, etc.</li>
<li>Multiplying these together we get <span class="math notranslate nohighlight">\((n-1)!  = (n-1) (n-2) . .  1\)</span>.</li>
<li>Now since our travel costs do not depend on the direction we take around the tour:<ul>
<li>this number by 2</li>
<li><span class="math notranslate nohighlight">\((n-1)!/2\)</span>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="simulated-annealing-algorithm">
<span id="simulated-annealing"></span><h2><a class="toc-backref" href="#id5">Simulated Annealing Algorithm</a><a class="headerlink" href="#simulated-annealing-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The simulated annealing algorithm was originally inspired from the process of
annealing in metal work.</p>
<p>Annealing involves heating and cooling a material to
alter its physical properties due to the changes in its internal structure.
As the metal cools its new structure becomes fixed,
consequently causing the metal to retain its newly obtained properties.</p>
<p class="rubric">Pseudocode</p>
<p>Given an initial solution, the simulated annealing process, will start with a high temperature
and gradually cool down until the desired temperature is reached.</p>
<p>For each temperature, a neighbouring new solution <strong>newSolution</strong> is calculated. The higher the temperature
the higher the probability of accepting the new solution as a possible bester solution.</p>
<p>Once the desired temperature is reached, the best solution found is returned</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Solution = initial_solution;

temperature = initial_temperature;
while (temperature &gt; final_temperature) {

    do tries_per_temperature times {
        newSolution = neighbour(solution);
        If P(E(solution), E(newSolution), T) &gt;= random(0, 1)
            solution = newSolution;
    }

    temperature = temperature * cooling factor;
}

Output: the best solution
</pre></div>
</div>
<div class="section" id="pgrouting-implementation">
<h3><a class="toc-backref" href="#id6">pgRouting Implementation</a><a class="headerlink" href="#pgrouting-implementation" title="Permalink to this headline">¶</a></h3>
<p>pgRouting’s implementation adds some extra parameters to allow some exit controls within the
simulated annealing process.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">max_changes_per_temperature</span></code>:<ul>
<li>Limits the number of changes in the solution per temperature</li>
<li>Count is reset to <span class="math notranslate nohighlight">\(0\)</span> when <strong>temperature</strong> changes</li>
<li>Count is increased by :math: <cite>1</cite> when <strong>solution</strong> changes</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">max_consecutive_non_changes</span></code>:<ul>
<li>Limits the number of consecutive non changes per temperature</li>
<li>Count is reset to <span class="math notranslate nohighlight">\(0\)</span> when <strong>solution</strong> changes</li>
<li>Count is increased by :math: <cite>1</cite> when <strong>solution</strong> changes</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">max_processing_time</span></code>:<ul>
<li>Limits the time the simulated annealing is performed.</li>
</ul>
</li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Solution = initial_solution;

temperature = initial_temperature;
WHILE (temperature &gt; final_temperature) {

    DO tries_per_temperature times {
        newSolution = neighbour(solution);
        If Probability(E(solution), E(newSolution), T) &gt;= random(0, 1)
            solution = newSolution;

        BREAK DO WHEN:
            max_changes_per_temperature is reached
            OR max_consecutive_non_changes is reached
    }

    temperature = temperature * cooling factor;
    BREAK WHILE WHEN:
        no changes were done in the current temperature
        OR max_processing_time has being reached
}

Output: the best solution found
</pre></div>
</div>
</div>
<div class="section" id="choosing-parameters">
<h3><a class="toc-backref" href="#id7">Choosing parameters</a><a class="headerlink" href="#choosing-parameters" title="Permalink to this headline">¶</a></h3>
<p>There is no exact rule on how the parameters have to be chose, it will depend on the
special characteristics of the problem.</p>
<ul class="simple">
<li>If the computational time is crucial, then limit execution time with <strong>max_processing_time</strong>.</li>
<li>Make the <strong>tries_per_temperture</strong> depending on the number of cities (<span class="math notranslate nohighlight">\(n\)</span>), for example:<ul>
<li>Useful to estimate the time it takes to do one cycle: use <cite>1</cite><ul>
<li>this will help to set a reasonable <strong>max_processing_time</strong></li>
</ul>
</li>
<li><span class="math notranslate nohighlight">\(n * (n-1)\)</span></li>
<li><span class="math notranslate nohighlight">\(500 * n\)</span></li>
</ul>
</li>
<li>For a faster decreasing the temperature set <strong>cooling_factor</strong> to a smaller number,
and set to a higher number for a slower decrease.</li>
<li>When for the same given data the same results are needed, set <strong>randomize</strong> to <cite>false</cite>.<ul>
<li>When estimating how long it takes to do one cycle: use <cite>false</cite></li>
</ul>
</li>
</ul>
<p>A recommendation is to play with the values and see what fits to the particular data.</p>
</div>
<div class="section" id="description-of-the-control-parameters">
<h3><a class="toc-backref" href="#id8">Description of the Control Parameters</a><a class="headerlink" href="#description-of-the-control-parameters" title="Permalink to this headline">¶</a></h3>
<p>The control parameters are optional, and have a default value.</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="7%" />
<col width="8%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Type</th>
<th class="head">Default</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>start_vid</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></td>
<td><cite>0</cite></td>
<td>The greedy part of the implementation will use this identifier.</td>
</tr>
<tr class="row-odd"><td><strong>end_vid</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></td>
<td><cite>0</cite></td>
<td>Last visiting vertex before returning to start_vid.</td>
</tr>
<tr class="row-even"><td><strong>max_processing_time</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><cite>+infinity</cite></td>
<td>Stop the annealing processing when the value is reached.</td>
</tr>
<tr class="row-odd"><td><strong>tries_per_temperature</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></td>
<td><cite>500</cite></td>
<td>Maximum number of times a neighbor(s) is searched in each temperature.</td>
</tr>
<tr class="row-even"><td><strong>max_changes_per_temperature</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></td>
<td><cite>60</cite></td>
<td>Maximum number of times the solution is changed in each temperature.</td>
</tr>
<tr class="row-odd"><td><strong>max_consecutive_non_changes</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></td>
<td><cite>100</cite></td>
<td>Maximum number of consecutive times the solution is not changed in each temperature.</td>
</tr>
<tr class="row-even"><td><strong>initial_temperature</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><cite>100</cite></td>
<td>Starting temperature.</td>
</tr>
<tr class="row-odd"><td><strong>final_temperature</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><cite>0.1</cite></td>
<td>Ending temperature.</td>
</tr>
<tr class="row-even"><td><strong>cooling_factor</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><cite>0.9</cite></td>
<td>Value between between 0 and 1 (not including) used to calculate the next temperature.</td>
</tr>
<tr class="row-odd"><td><strong>randomize</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">BOOLEAN</span></code></td>
<td><cite>true</cite></td>
<td><p class="first">Choose the random seed</p>
<ul class="last simple">
<li>true: Use current time as seed</li>
<li>false: Use <cite>1</cite> as seed. Using this value will get the same results with the same data in each execution.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="description-of-the-return-columns">
<h2><a class="toc-backref" href="#id9">Description of the return columns</a><a class="headerlink" href="#description-of-the-return-columns" title="Permalink to this headline">¶</a></h2>
<p>Returns SET OF <code class="docutils literal notranslate"><span class="pre">(seq,</span> <span class="pre">node,</span> <span class="pre">cost,</span> <span class="pre">agg_cost)</span></code></p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="10%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Column</th>
<th class="head">Type</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>seq</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">INTEGER</span></code></td>
<td>Row sequence.</td>
</tr>
<tr class="row-odd"><td><strong>node</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">BIGINT</span></code></td>
<td>Identifier of the node/coordinate/point.</td>
</tr>
<tr class="row-even"><td><strong>cost</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><dl class="first last docutils">
<dt>Cost to traverse from the current <code class="docutils literal notranslate"><span class="pre">node</span></code> to the next <code class="docutils literal notranslate"><span class="pre">node</span></code> in the path sequence.</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">0</span></code> for the last row in the path sequence.</li>
</ul>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><strong>agg_cost</strong></td>
<td><code class="docutils literal notranslate"><span class="pre">FLOAT</span></code></td>
<td><dl class="first last docutils">
<dt>Aggregate cost from the <code class="docutils literal notranslate"><span class="pre">node</span></code> at <code class="docutils literal notranslate"><span class="pre">seq</span> <span class="pre">=</span> <span class="pre">1</span></code> to the current node.</dt>
<dd><ul class="first last simple">
<li><code class="docutils literal notranslate"><span class="pre">0</span></code> for the first row in the path sequence.</li>
</ul>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="section" id="see-also">
<h3><a class="toc-backref" href="#id10">See Also</a><a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h3>
<p class="rubric">References</p>
<ul class="simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Traveling_salesman_problem">Wikipedia: Traveling Salesman Problem</a></li>
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Simulated_annealing">Wikipedia: Simulated annealing</a></li>
</ul>
<p class="rubric">Indices and tables</p>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright pgRouting Contributors - Version v3.1.4.<br/>
      Last updated on Oct 23, 2021.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>